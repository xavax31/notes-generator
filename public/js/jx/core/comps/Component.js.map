{"version":3,"sources":["../../../../src/jx/core/comps/Component.js"],"names":["Component","dataObject","defaultValue","Object","assign","id","parentComponent","data","initialise","IDTarget","autoStart","isJXComponent","_paused","jx","tools","obj","merge","_initialise","_killed","comps","kill","_removeAllEventDispatchers","_jx_remove_listeners","remove","_jx_listeners","onpause","pause","evt","onresume","resume","onclose","close","onappfreeze","appFreeze","onappunfreeze","appUnfreeze","add","_create","_initSync","_id","ComponentsCollection","_eventsdispatchers","addEventDispatcher","_ready","initialising","_closed","oninitialised","onInitialised","addOnce","start","setTimeout","callback","firstinit","dispatch","target","_preInit","init","_postInit","console","log","_appFreezed","comp","addID","instanceType","db","findOne","i","length","push","cc","undefined","ccid","args","signals","Signal","dispatcher","removeAll","value","parentcomp","_children","index","indexOf","splice","forEach","arr","childrenArr","slice","path","pathArr","split","shift","getByPath","join","itemsToInit","item","ready","notInit","itemsInitialising","oninit","func"],"mappings":"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","file":"Component.js","sourcesContent":["import JXObject from \"jx/core/JXObject\";\n/**\n * All components implements Component class.\n */\nexport default class Component extends JXObject {\n    constructor(dataObject, defaultValue = {}) {\n        super(Object.assign({\n            id: null,\n            parentComponent: null,\n            data: null,\n            initialise: false,\n            IDTarget: null,\n            autoStart: true\n        }, dataObject));\n        this.isJXComponent = true;\n        this._paused = false;\n        /** dataObject provided as argument for construction of component, merged with default values.*/\n        this.dataObject = this.jx.tools.obj.merge(this.dataObject, defaultValue);\n        this.parentComponent = this.dataObject.parentComponent;\n        //console.log(\"Component constructor\", this.dataObject)\n        this._initialise();\n    }\n    /** */\n    kill() {\n        if (this._killed)\n            return;\n        this._killed = true;\n        this.comps.kill();\n        this._removeAllEventDispatchers();\n        this._jx_remove_listeners();\n        if (this.parentComponent) {\n            this.parentComponent.comps.remove(this); // remove reference in parentComponent\n        }\n        ;\n        this.parentComponent = null;\n        this._jx_listeners = null;\n        this.comps = null;\n        this.dataObject = null;\n        this.data = null;\n        this.jx = null;\n    }\n    _jx_add_listeners() {\n        this._jx_listeners = {\n            onpause: evt => this.pause(evt),\n            onresume: evt => this.resume(evt),\n            onclose: evt => this.close(evt),\n            onappfreeze: evt => this.appFreeze(evt),\n            onappunfreeze: evt => this.appUnfreeze(evt)\n        };\n        this.jx.onappfreeze.add(this._jx_listeners.onappfreeze);\n        this.jx.onappunfreeze.add(this._jx_listeners.onappunfreeze);\n        if (this.parentComponent) {\n            this.parentComponent.onpause.add(this._jx_listeners.onpause);\n            this.parentComponent.onresume.add(this._jx_listeners.onresume);\n            this.parentComponent.onclose.add(this._jx_listeners.onclose);\n        }\n        ;\n    }\n    _jx_remove_listeners() {\n        if (!this._jx_listeners)\n            return;\n        this.jx.onappfreeze.remove(this._jx_listeners.onappfreeze);\n        this.jx.onappunfreeze.remove(this._jx_listeners.onappunfreeze);\n        if (this.parentComponent) {\n            this.parentComponent.onpause.remove(this._jx_listeners.onpause);\n            this.parentComponent.onresume.remove(this._jx_listeners.onresume);\n            this.parentComponent.onclose.remove(this._jx_listeners.onclose);\n        }\n    }\n    _initialise() {\n        //console.log(\"Component _initialise\", this)\n        this._create();\n        this._initSync();\n        return this;\n    }\n    _create() {\n        //console.log(\"Component _create\", this)\n        this.isJXComponent = true;\n        /** */\n        this._id = this.dataObject.id;\n        /**\n        * object ready to associate custom data to this component.\n        * this data can be provided when creating component with this.cc({type:MyComp, data: AnyDataValue}), or change at any time.\n        * Generally for be used later by others component which manipulate it.\n        */\n        this.data = this.dataObject.data;\n        this.IDTarget = this.dataObject.IDTarget;\n        /** @type {ComponentsCollection} */\n        this.comps = new ComponentsCollection(this);\n        this._eventsdispatchers = [];\n        this.addEventDispatcher(\"onInitialised\", \"firstinit\", \"onchanged\", \"onpause\", \"onresume\", \"onclose\");\n        this._ready = false;\n        this.initialising = false;\n        this._paused = false;\n        this._closed = false;\n    }\n    get id() {\n        return this._id;\n    }\n    set id(value) {\n        //-- rename the component also in parentComponent if it's use as parent property.\n        if (this._id && this.parentComponent) {\n            if (this.parentComponent[this._id] === this) {\n                delete this.parentComponent[this._id];\n                this.parentComponent[value] = this;\n            }\n            if (this.parentComponent.comps[this._id] === this) {\n                delete this.parentComponent.comps[this._id];\n                this.parentComponent.comps[value] = this;\n            }\n        }\n        this._id = value;\n    }\n    /**\n    * @protected\n    */\n    _initSync() {\n        //console.log(\"Component _initSync\", this)\n        if (this.dataObject.oninitialised)\n            this.onInitialised.addOnce(this.dataObject.oninitialised);\n        if (this._ready && this.dataObject.autoStart) {\n            this.start();\n        }\n        else if (this.dataObject.initialise == true) {\n            setTimeout(evt => this.initialise(this.dataObject.oninitialised), 0); // needed for correct return of this by construct before call initialise.\n        }\n    }\n    initialise(callback) {\n        this.firstinit.addOnce(callback);\n        //console.log(\"Component initialise\", this)\n        if (this._ready) {\n            this.firstinit.dispatch({ target: this });\n            return;\n        }\n        if (this.initialising) {\n            return;\n        }\n        this.initialising = true;\n        this._preInit(evt => this.init(evt => this._postInit(evt => {\n            this._ready = true;\n            this.initialising = false;\n            if (this.dataObject.autoStart) {\n                this.start();\n            }\n            this.firstinit.dispatch({ target: this });\n            //callback ({target: this});\t\t\t\n        })));\n        return this;\n    }\n    /**\n    * @protected\n    */\n    _preInit(callback) {\n        //console.log(\"Component _preInit\", this)\n        callback();\n    }\n    /**\n    * @protected\n    */\n    init(callback) {\n        //console.log(\"Component _init\", this)\n        callback();\n    }\n    /**\n    * @protected\n    */\n    _postInit(callback) {\n        //console.log(\"Component _postInit\", this)\n        callback();\n    }\n    /**\n    * @protected\n    */\n    _firstInit() {\n    }\n    /** */\n    _start() {\n    }\n    /** */\n    start() {\n    }\n    pause() {\n        console.log(\"pause\", this);\n        if (this._paused)\n            return false;\n        this._paused = true;\n        this.onpause.dispatch({ target: this });\n        // this.comps.forEach(comp=>{\n        // \tcomp.pause();\n        // })\n        return true;\n    }\n    _pause() {\n    }\n    resume() {\n        console.log(\"resume\", this);\n        if (!this._paused)\n            return false;\n        this._paused = false;\n        this.onresume.dispatch({ target: this });\n        // this.comps.forEach(comp=>{\n        // \tcomp.resume();\n        // })\n        return true;\n    }\n    appFreeze() {\n        if (this._appFreezed)\n            return;\n        this._appFreezed = true;\n        console.log(\"appfreeze\", this);\n    }\n    appUnfreeze() {\n        console.log(\"appUnfreeze\", this);\n        if (!this._appFreezed)\n            return;\n        this._appFreezed = false;\n    }\n    close() {\n        console.log(\"close\", this);\n        if (this._closed)\n            return false;\n        this._closed = false;\n        this.pause();\n        this.onclose.dispatch({ target: this });\n        // this.comps.forEach(comp=>{\n        // \tcomp.close();\n        // })\n        return true;\n    }\n    /** @type {boolean} */\n    // set _pause(value) {\n    // \tif (this._paused == value) return;\n    // \tthis._paused = value;\n    // \tthis.comps.forEach(comp=>{\n    // \t\tcomp.pause = this._paused;\n    // \t})\n    // }\n    // /** @type {boolean} */\n    // get _pause() {\n    // \treturn this._paused;\n    // }\n    /**\n    * Create and add, or just add, a new Component as child.\n    * @return {Component}\n    */\n    cc(dataObject = {}) {\n        // this.jx.log(\"cc\", dataObject);\n        if (dataObject.isJXComponent) { // if arg is Component, we juste add it to _children\n            let comp = dataObject;\n            if (comp.parentComponent) {\n                comp.parentComponent.comps.remove(comp);\n            }\n            comp.parentComponent = this;\n            this.comps.add(comp, comp.addID);\n            return comp;\n        }\n        else if (this.jx.tools.instanceType(dataObject) == \"string\") { // resourceID given as argument.\n            dataObject = this.jx.db.findOne({ id: dataObject }).data;\n        }\n        if (this.jx.tools.instanceType(dataObject) == \"array\") { // array of comps to create.\n            let comps = [];\n            for (var i = 0; i < dataObject.length; i++) {\n                comps.push(this.cc(dataObject[i]));\n            }\n            return comps;\n        }\n        dataObject.parentComponent = dataObject.parentComponent || this; //?\n        let comp = this.jx.cc(dataObject);\n        this.comps.add(comp, dataObject.addID);\n        return comp;\n    }\n    /**\n     * Same as cc(), but add a property with same id than dataObject.id.\n     * This a shortcut for this use:\n     *\n     * @example\n     * this.ccid({id: \"myID\"});\n     * this.myID.onclick.add(evt=>console.log(evt.target.id)); // show myID\n\n     * // equal to :\n     * this.myID = this.cc({id: \"myID\"});\n     * this.myID.onclick.add(evt=>console.log(evt.target.id)); // show myID\n     *\n     * // equal to :\n     * this.myID = this.cc();\n     * this.myID.id = \"myID\";\n     * this.myID.onclick.add(evt=>console.log(evt.target.id)); // show myID\n     *\n     * @param  {Object} dataObject [description]\n     * @return {[type]}            [description]\n     */\n    ccid(dataObject = {}) {\n        if (dataObject.isJXComponent) { // if arg is Component, we juste add it to _children\n            let comp = dataObject;\n            comp.addID == undefined ? true : comp.addID;\n            return this.cc(comp);\n        }\n        else if (this.jx.tools.instanceType(dataObject) == \"string\") { // resourceID given as argument.\n            dataObject = this.jx.db.findOne({ id: dataObject }).data;\n        }\n        if (this.jx.tools.instanceType(dataObject) == \"array\") { // array of comps to create.\n            let comps = [];\n            for (var i = 0; i < dataObject.length; i++) {\n                comps.push(this.ccid(dataObject[i]));\n            }\n            return comps;\n        }\n        dataObject.addID = dataObject.addID == undefined ? true : dataObject.addID;\n        return this.cc(dataObject);\n    }\n    /**\n    * Component is ready when it is created, initialised with both sync and async initialisations.\n    * It is then considered as ready to use in application code.\n    * @type {boolean}\n    */\n    get ready() {\n        return this._ready;\n    }\n    /**\n    * Add new event dispatcher.\n    * @example\n    * this.addEventDispatcher(\"onchanged\");\n    * this.onchanged.add(evt=>console.log(evt));\n    * this.onchanged.dispatch({mess: \"i'm changed now\"});\n    */\n    addEventDispatcher(...args) {\n        for (var i = 0; i < args.length; i++) {\n            this[args[i]] = new signals.Signal();\n            this._eventsdispatchers.push({ id: args[i], dispatcher: this[args[i]] });\n        }\n        ;\n    }\n    _removeAllEventDispatchers() {\n        for (var i = 0; i < this._eventsdispatchers.length; i++) {\n            this._eventsdispatchers[i].dispatcher.removeAll();\n            if (this[this._eventsdispatchers[i].id])\n                delete this[this._eventsdispatchers[i].id];\n        }\n        ;\n        this._eventsdispatchers.length = 0;\n    }\n}\n/** */\nclass ComponentsCollection {\n    constructor(parentcomp) {\n        this.parentcomp = parentcomp;\n        this._children = [];\n    }\n    get array() {\n        return this._children;\n    }\n    /** */\n    add(comp, addID) {\n        this._children.push(comp);\n        if (comp.id != undefined) {\n            if (addID) {\n                this.parentcomp[comp.id] = comp;\n            }\n            this[comp.id] = comp;\n        }\n    }\n    /** */\n    remove(comp) {\n        var index = this._children.indexOf(comp);\n        if (index != -1) {\n            this._children.splice(index, 1);\n            if (comp.id) {\n                if (this.parentcomp[comp.id]) {\n                    delete this.parentcomp[comp.id];\n                }\n                if (this[comp.id]) {\n                    delete this[comp.id];\n                }\n            }\n        }\n    }\n    /** */\n    removeAll() {\n        this._children.forEach((comp, index, arr) => {\n            if (comp.id) {\n                if (this.parentcomp[comp.id]) {\n                    delete this.parentcomp[comp.id];\n                }\n                if (this[comp.id]) {\n                    delete this[comp.id];\n                }\n            }\n        });\n        this._children = [];\n    }\n    /** */\n    kill() {\n        let childrenArr = this._children.slice();\n        childrenArr.forEach((comp, index, arr) => {\n            if (comp.id) {\n                if (this.parentcomp[comp.id]) {\n                    delete this.parentcomp[comp.id];\n                }\n                if (this[comp.id]) {\n                    delete this[comp.id];\n                }\n            }\n            comp.kill();\n        });\n        this._children = [];\n    }\n    /**\n     * Return component child with path, depends of its id.\n     * @example\n     * var comp = this.getChildByPath(\"child1ID.child2ID\");\n     * @param  {string} path\n     * @return {Component}\n     */\n    getByPath(path) {\n        var pathArr = path.split(\".\");\n        for (var i = 0; i < this._children.length; i++) {\n            if (this._children[i].id == pathArr[0]) {\n                pathArr.shift();\n                if (pathArr.length == 0) {\n                    return this._children[i];\n                }\n                else {\n                    return this._children[i].comps.getByPath(pathArr.join(\".\"));\n                }\n            }\n            ;\n        }\n        ;\n        return null;\n    }\n    /**\n    * Initialise all children and callback when all initialised, sync or async.\n    * @param {function(evt:Object): void} callback - called when all components are initialised.\n    */\n    initChildren(callback) {\n        var itemsToInit = [];\n        this.forEach(item => {\n            if (!item.ready && item.initialise && item.notInit != true) {\n                itemsToInit.push(item);\n            }\n            ;\n        });\n        var itemsInitialising = itemsToInit.slice();\n        var oninit = evt => {\n            //console.log(evt,itemsToInit,  itemsToInit.indexOf(evt.target))\n            itemsInitialising.splice(itemsInitialising.indexOf(evt.target), 1);\n            //console.log(itemsInitialising)\n            if (itemsInitialising.length == 0) {\n                callback({ target: this });\n            }\n            ;\n        };\n        if (itemsToInit.length == 0) {\n            callback({ target: this });\n            return;\n        }\n        for (var i = 0; i < itemsToInit.length; i++) {\n            itemsToInit[i].initialise(oninit);\n        }\n    }\n    /**\n    * Execute a foreach routine on all children components.\n    */\n    forEach(func) {\n        this._children.forEach((item, index, arr) => {\n            func(item, index);\n        });\n    }\n}\n"]}