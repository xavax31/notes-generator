{"version":3,"sources":["../../../../src/jx/core/loaders/SoundLoader.js"],"names":["SoundLoader","resource","onFinished","jx","_loader","success","createjs","LoadQueue","installPlugin","Sound","on","_resourceLoaded","_resourceFailed","loadFile","id","src","removeAllEventListeners","removeAll","destroy","event","removeEventListener","data","ready","target","console","log","title"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAAqBA,W;AACjB,6BAAYC,QAAZ,EAAsBC,UAAtB,EAAkCC,EAAlC,EAAsC;AAAA;;AAClC,iBAAKA,EAAL,GAAUA,EAAV;AACA,iBAAKC,OAAL,GAAe,IAAf;AACA,iBAAKH,QAAL,GAAgBA,QAAhB;AACA,iBAAKC,UAAL,GAAkBA,UAAlB;AACA,iBAAKG,OAAL,GAAe,KAAf;AACH;;;;mCACM;AACH,qBAAKD,OAAL,GAAe,IAAIE,SAASC,SAAb,EAAf;AACA,qBAAKH,OAAL,CAAaI,aAAb,CAA2BF,SAASG,KAApC;AACA,qBAAKL,OAAL,CAAaM,EAAb,CAAgB,UAAhB,EAA4B,KAAKC,eAAjC,EAAkD,IAAlD;AACA,qBAAKP,OAAL,CAAaM,EAAb,CAAgB,OAAhB,EAAyB,KAAKE,eAA9B,EAA+C,IAA/C;AACA,qBAAKR,OAAL,CAAaS,QAAb,CAAsB,EAAEC,IAAI,KAAKb,QAAL,CAAca,EAApB,EAAwBC,KAAK,KAAKd,QAAL,CAAcc,GAA3C,EAAtB;AACH;;;mCACM;AACH,oBAAI,CAAC,KAAKZ,EAAV,EACI;AACJ,qBAAKC,OAAL,CAAaY,uBAAb;AACA,qBAAKZ,OAAL,CAAaa,SAAb;AACA,qBAAKb,OAAL,CAAac,OAAb;AACA,qBAAKd,OAAL,GAAe,IAAf;AACA,qBAAKF,UAAL,GAAkB,IAAlB;AACA,qBAAKD,QAAL,GAAgB,IAAhB;AACA,qBAAKE,EAAL,GAAU,IAAV;AACH;;;4CACegB,K,EAAO;AAEnB,qBAAKf,OAAL,CAAagB,mBAAb,CAAiC,UAAjC,EAA6C,KAAKT,eAAlD;AACA,qBAAKP,OAAL,CAAagB,mBAAb,CAAiC,OAAjC,EAA0C,KAAKR,eAA/C;AACA,qBAAKX,QAAL,CAAcoB,IAAd,GAAqB,EAArB;AACA,qBAAKpB,QAAL,CAAcqB,KAAd,GAAsB,IAAtB;AACA,qBAAKjB,OAAL,GAAe,IAAf;AACA,qBAAKH,UAAL,CAAgB,EAAEqB,QAAQ,IAAV,EAAgBtB,UAAU,KAAKA,QAA/B,EAAyCI,SAAS,IAAlD,EAAhB;AACH;;;4CACec,K,EAAO;AACnBK,wBAAQC,GAAR,CAAY,QAAQN,MAAMO,KAAd,GAAsB,IAAtB,GAA6B,KAAKzB,QAAL,CAAca,EAA3C,GAAgD,IAAhD,GAAuD,KAAKb,QAAL,CAAcc,GAAjF;AACA,qBAAKX,OAAL,CAAagB,mBAAb,CAAiC,UAAjC,EAA6C,KAAKT,eAAlD;AACA,qBAAKP,OAAL,CAAagB,mBAAb,CAAiC,OAAjC,EAA0C,KAAKR,eAA/C;AACA,qBAAKP,OAAL,GAAe,KAAf;AACA,qBAAKH,UAAL,CAAgB,EAAEqB,QAAQ,IAAV,EAAgBtB,UAAU,KAAKA,QAA/B,EAAyCI,SAAS,KAAlD,EAAhB;AACH;;;;;;sBAzCgBL,W","file":"SoundLoader.js","sourcesContent":["export default class SoundLoader {\n    constructor(resource, onFinished, jx) {\n        this.jx = jx;\n        this._loader = null;\n        this.resource = resource;\n        this.onFinished = onFinished;\n        this.success = false;\n    }\n    load() {\n        this._loader = new createjs.LoadQueue();\n        this._loader.installPlugin(createjs.Sound);\n        this._loader.on(\"fileload\", this._resourceLoaded, this);\n        this._loader.on(\"error\", this._resourceFailed, this);\n        this._loader.loadFile({ id: this.resource.id, src: this.resource.src });\n    }\n    kill() {\n        if (!this.jx)\n            return;\n        this._loader.removeAllEventListeners();\n        this._loader.removeAll();\n        this._loader.destroy();\n        this._loader = null;\n        this.onFinished = null;\n        this.resource = null;\n        this.jx = null;\n    }\n    _resourceLoaded(event) {\n        //console.log( 'resourceLoaded '+event.title+\"\\n\"+this.resource.id +\"\\n\"+ this.resource.src);\n        this._loader.removeEventListener(\"fileload\", this._resourceLoaded);\n        this._loader.removeEventListener(\"error\", this._resourceFailed);\n        this.resource.data = {};\n        this.resource.ready = true;\n        this.success = true;\n        this.onFinished({ target: this, resource: this.resource, success: true });\n    }\n    _resourceFailed(event) {\n        console.log('err' + event.title + \"\\n\" + this.resource.id + \"\\n\" + this.resource.src);\n        this._loader.removeEventListener(\"fileload\", this._resourceLoaded);\n        this._loader.removeEventListener(\"error\", this._resourceFailed);\n        this.success = false;\n        this.onFinished({ target: this, resource: this.resource, success: false });\n    }\n}\n"]}