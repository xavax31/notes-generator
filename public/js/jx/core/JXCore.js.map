{"version":3,"sources":["../../../src/jx/core/JXCore.js"],"names":["version","JXCore","debug","window","onerror","errorMsg","url","lineNumber","column","errorObj","search","alert","comp","tools","Object","assign","Function","mergeObject","is","v1","v2","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","config","db","factory","cc","p","createComp","log","console","bind","_killed","kill","ticker","memo","layout","fx","global","_lastJX","requirejs","undef","err","warn","loadingScreen","findOne","data","jx","dj","classID","id","_lastRender"],"mappings":"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","file":"JXCore.js","sourcesContent":["import DBManager from \"jx/core/DBManager\";\nimport Factory from \"jx/core/Factory\";\nimport Config from \"jx/core/Config\";\nimport Tools from \"jx/core/utils/Tools\";\nimport Debugger from \"jx/core/Debugger\";\nlet version = \"0.2.0\";\n/**\n * JX Engine, accessible inside each component by its jx property.\n * @ignore\n * @example\n * var result = this.jx.tools.gd(3, 2);\n */\nexport default class JXCore {\n    constructor({ debug = false }) {\n        window[\"jx\"] = this;\n        if (debug) {\n            // show alert on error\n            window.onerror = function (errorMsg, url, lineNumber, column, errorObj) {\n                if (errorMsg.search(\"afdp\") == -1) { // don't alert for this error triggered by aquafadas\n                    alert('Error: ' + errorMsg + ' Script: ' + url + ' Line: ' + lineNumber + ' Column: ' + column + ' StackTrace: ' + errorObj);\n                }\n                ;\n            };\n        }\n        ;\n        this.comp = {};\n        /** @type {Tools} */\n        this.tools = new Tools();\n        //-- hacks for older browsers\n        // Object.assign\n        if (!(Object.assign instanceof Function)) {\n            Object.assign = this.tools.mergeObject;\n        }\n        // Object.is (https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Objets_globaux/Object/is)\n        if (!Object.is) {\n            Object.is = function (v1, v2) {\n                // Algorithme SameValue\n                if (v1 === v2) { //Étapes 1-5, 7-10\n                    //Étapes 6.b-6.b +0 !=-0\n                    return v1 !== 0 || 1 / v1 === 1 / v2;\n                }\n                else {\n                    //Étapes 6.a: NaN == NaN\n                    return v1 !== v1 && v2 !== v2;\n                }\n            };\n        }\n        window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;\n        /** @type {Config} */\n        this.config = new Config(this);\n        /** @type {DBManager} */\n        this.db = new DBManager(this);\n        /** @type {Factory} */\n        this.factory = new Factory(this);\n        /** @type {Factory} */\n        this.debug = new Debugger(this, debug);\n        //--- shortcuts\n        /** Shortcut for {@link Factory.createComp}. */\n        this.cc = (p) => this.factory.createComp(p);\n        this.log = console.log.bind(console);\n    }\n    kill() {\n        if (this._killed)\n            return;\n        this._killed = true;\n        try {\n            this.db.kill();\n            this.db = null;\n            this.config.kill();\n            this.config = null;\n            this.factory.kill();\n            this.factory = null;\n            this.debug.kill();\n            this.debug = null;\n            this.comp = null;\n            this.ticker = null;\n            this.memo = null;\n            this.layout = null;\n            this.fx = null;\n            this.log = null;\n            this.global = null;\n            this.tools = null;\n            this.cc = null;\n            this.log = null;\n            this._lastJX = null;\n            window[\"jx\"] = null;\n            window[\"jxCore\"] = null;\n            requirejs.undef(\"jx/core/DBManager\");\n        }\n        catch (err) {\n            console.warn(\"errors while killing application\", err);\n        }\n    }\n    _initialise() {\n        this.loadingScreen = new (this.db.findOne({ \"id\": \"BusyScreen\" }).data)({ jx: this });\n        /** @type {MemoManager} */\n        this.memo = new (this.db.findOne({ \"id\": \"MemoManager\" }).data)({ jx: this });\n        /** @type {Layout} */\n        this.layout = new (this.db.findOne({ \"id\": \"Layout\" }).data)({ jx: this });\n        /** @type {FXManager} */\n        this.fx = new (this.db.findOne({ \"id\": \"FXManager\" }).data)({ jx: this });\n        /** @type {SoundManager} */\n        this.dj = new (this.db.findOne({ \"id\": \"SoundManager\" }).data)({ jx: this });\n    }\n    extendsFrom(classID) {\n        console.log(\"extendsFrom\", this._lastJX);\n        if (this._lastJX) {\n            return this._lastJX.db.findOne({ id: classID + this._lastRender }).data;\n        }\n        return null;\n    }\n    toString() { return \"JXCore v\" + version; }\n    get version() {\n        return version;\n    }\n    ;\n}\n"]}