{"version":3,"sources":["../../../../src/jx/core/presets/GameModule.js"],"names":["GameModule","dataObject","Object","assign","plugs","importData","jx","playComment","params","saveImageToGallery","callback","debug","info","_logTiming","target","loadPlugs","_importConfig","initBayam","_jxInit","_loadResources","window","push","moduleReady","Date","now","startbtnInfos","show","config","app","startButton","heightPercent","startButtonHeightPercent","console","log","system","needUserActionToWork","loadingScreen","hideSpinner","onStartBtn","showStartButton","height","onclick","wait","hide","screens","give","firstScreen","type","view","play","configLoad","importConfig","configLoaded","jx_initialise","_initialise","concat","moduleData","jx_Initialised","memo","addMemo","id","autosave","_debugStartTime","loadResources","i","resources","length","lang","langs","value","split","trim","db","addResources","_onBeforeLoad","load","init","resourcesLoaded","closeApplication","_appFreezed","_stateBeforeFreeze","onInitialised","container","onReady","event","clientContext","data","onVolumeChange","alert","volume","_bayamFrontCom","BayamFrontCom","onPause","pauseApplication","onResume","resumeApplication","onClose","x","y","width","outputWidth","onfinished","stage","_stage","cache","img","getCacheDataURL","onsuccess","evt","success","onfail","uncache","open","desc","sendCreation","imageData","replace","parent","postMessage","method","responseID","iframe","document","write","close","resource","findOne","loader","onloaded","addOnce","zap","preloadSound","player","dj","createPlayer","streaming","endFunc","cancel","unblockInteractivity","blockInteractivity","voice","result","firstTime","lastTime","jxTiming","prop"],"mappings":"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","file":"GameModule.js","sourcesContent":["import Component from \"jx/core/comps/Component\";\nimport SoundLoader from \"jx/core/loaders/SoundLoaderMediaElement\";\nimport Importer from \"jx/projecttypes/simplejson/Importer\";\n/**\n * Base class for Module ready to use.\n */\nexport default class GameModule extends Component {\n    constructor(dataObject) {\n        super(Object.assign({\n            plugs: []\n        }, dataObject));\n        this.importData = null;\n        this.jx.playComment = params => this.playComment(params);\n        this.jx.saveImageToGallery = params => this.saveImageToGallery(params);\n    }\n    kill() {\n        // console.info(\"killing\", this)\n        this.jx.playComment = null;\n        this.jx.saveImageToGallery = null;\n        super.kill();\n        // console.info(\"killed\", this)\n    }\n    initialise(callback) {\n        //console.log(\"> initialise\", this)\n        super.initialise(evt => {\n            this.jx.debug.info(\"------- GameModule initialised -------\");\n            // window[\"jxTiming\"].push({moduleReady:Date.now()});\n            this._logTiming();\n            //$(\"body\").append(\"<p style='display:inline'>\" + this._logTimingHTML() + \"</p>\")\n            callback({ target: this });\n        });\n        return this;\n    }\n    _preInit(callback) {\n        //console.info(\"GameModule preInit\", this)\n        super._preInit(evt => {\n            this.jx.loadPlugs([], evt => this._importConfig(evt => this.initBayam(evt => this._jxInit(evt => this._loadResources(evt => callback())))));\n        });\n    }\n    /**\n     */\n    init(callback) {\n        //console.log(\"GameModule _init\", this);\n        callback();\n    }\n    _postInit(callback) {\n        //console.log(\"GameModule postInit\", this)\n        super._postInit(evt => {\n            window[\"jxTiming\"].push({ moduleReady: Date.now() });\n            let startbtnInfos = {\n                show: this.jx.config.app.startButton,\n                heightPercent: (this.jx.config.app.startButtonHeightPercent) + \"%\"\n            };\n            console.log(\"STARTBTN\", startbtnInfos, this.jx.config.system.needUserActionToWork);\n            if (startbtnInfos.show == \"yes\"\n                || (startbtnInfos.show == \"auto\" && this.jx.config.system.needUserActionToWork)) {\n                this.jx.loadingScreen.hideSpinner();\n                if (this.onStartBtn) { // hack only for NEWS_01_ANGLE, not used since refactoring (to remove when refactoring is finished)\n                    this.jx.loadingScreen.showStartButton({ height: startbtnInfos.heightPercent, onclick: () => {\n                            this.onStartBtn();\n                            this.jx.wait(0, evt => this.jx.loadingScreen.hide());\n                        } });\n                    callback();\n                }\n                else if (this.screens) {\n                    if (this.screens.give(this.firstScreen).type == \"video\") {\n                        this.jx.loadingScreen.showStartButton({ height: startbtnInfos.heightPercent, onclick: () => {\n                                this.screens.give(this.firstScreen).view.play();\n                                this.jx.wait(0, evt => this.jx.loadingScreen.hide());\n                            } });\n                        callback();\n                    }\n                    else {\n                        this.jx.loadingScreen.showStartButton({ height: startbtnInfos.heightPercent, onclick: () => {\n                                this.jx.wait(0, evt => this.jx.loadingScreen.hide());\n                                callback();\n                            } });\n                    }\n                }\n            }\n            else {\n                this.jx.wait(0, evt => this.jx.loadingScreen.hide());\n                callback();\n            }\n        });\n    }\n    _importConfig(callback) {\n        window[\"jxTiming\"].push({ configLoad: Date.now() });\n        new Importer(this.jx, null).importConfig((importData) => {\n            window[\"jxTiming\"].push({ configLoaded: Date.now() });\n            this.importData = importData;\n            //console.log(\"config.json loaded\")\n            callback();\n        });\n        //--- Get Comprehensive data from importer of type typeID (cf dir jx/projecttypes/).\n        // importData retrieved by importer must be of type dataobjects/ImportData\n        // this.jx.db.importConfig(\"SimpleJSON\", (importData)=>{\n        // \twindow[\"jxTiming\"].push({configLoaded:Date.now()});\n        //  \tthis.importData = importData; \n        //  \t//console.log(\"config.json loaded\")\n        //  \tcallback();\n        // });\n    }\n    _jxInit(callback) {\n        window[\"jxTiming\"].push({ jx_initialise: Date.now() });\n        this.jx._initialise({\n            plugs: [\"CJS\", \"DOM\"].concat(this.dataObject.plugs),\n            moduleData: this.importData\n        }, evt => {\n            window[\"jxTiming\"].push({ jx_Initialised: Date.now() });\n            this.jx.memo.addMemo({ id: \"global\" });\n            this.jx.memo.addMemo({ id: \"cookie\", type: \"Cookie\", autosave: true });\n            callback();\n        });\n        //this.jx.config.setProjectInfo(this.importData.projectInformations);\n        // this.jx.debug.init();\n    }\n    _loadResources(callback) {\n        this._debugStartTime = Date.now();\n        //console.log(\"module resources loading\", (Date.now() - this._debugStartTime)/1000, \"secondes\");\n        window[\"jxTiming\"].push({ loadResources: Date.now() });\n        for (var i = 0; i < this.importData.resources.length; i++) {\n            if (this.importData.resources[i].id == \"Langues\") {\n                var lang = this.importData.resources[i];\n                var langs = lang.value.split(\",\");\n                for (var i = 0; i < langs.length; i++) {\n                    langs[i] = langs[i].trim();\n                }\n                ;\n                if (langs.length > 0) {\n                    this.jx.config.langs = langs;\n                    this.jx.config.lang = langs[0];\n                }\n                ;\n                break;\n            }\n        }\n        ;\n        //console.log(langs)\n        this.jx.db.addResources(this.importData.resources);\n        this._onBeforeLoad(() => {\n            // Load Classes first\n            this.jx.db.load({ \"type\": \"class\" }, () => {\n                //--- load resources\n                //this.jx.debug.logTime(\"Module Classes loaded\", this.id || \"Module\");\n                this.jx.db.load({ \"preload\": true }, () => {\n                    //this.jx.global.debug.logTime(\"Module Resources loaded\", this.id || \"Module\");\n                    this.jx.config.init();\n                    //console.info(\"THIS ressources loaded\")\n                    window[\"jxTiming\"].push({ resourcesLoaded: Date.now() });\n                    callback();\n                });\n            });\n        });\n    }\n    /**\n     * Could be override in MainCtrl if changes by code needed before load resources.\n     * @param  {Function} callback\n     */\n    _onBeforeLoad(callback) {\n        callback();\n    }\n    // /**\n    //  */\n    // start() {\n    // \tsuper.start();\n    // }\n    // _start(callback) {\n    // \tconsole.log(\"_START\");\n    // \tthis._ready = true;\n    // \tthis.jx.wait(0, evt=>this.jx.loadingScreen.hide());\n    // \tthis.start({onStarted: evt=>{}});\n    // \tcallback();\n    // }\n    pause() {\n        super.pause();\n    }\n    resume() {\n        super.resume();\n    }\n    close() {\n        super.close();\n        //this._bayamFrontCom.sendCloseRequest(); // close request sent to container\n    }\n    onPause() {\n    }\n    onResume() {\n    }\n    onClose() {\n        this.jx.closeApplication();\n    }\n    appFreeze() {\n        //console.log(\"freeze\", this);\n        if (this._appFreezed)\n            return false;\n        this._stateBeforeFreeze = {};\n        super.appFreeze();\n    }\n    appUnfreeze() {\n        //console.log(\"unfreeze\", this);\n        if (!this._appFreezed)\n            return false;\n        super.appUnfreeze();\n    }\n    initBayam(onInitialised) {\n        //console.log(\"Bayam Init\", this.jx.config.system.container.type)\n        this.id = this.id || \"Module1\";\n        if (this.jx.config.system.container.type == \"bayam\") {\n            this._bayamFrontCom = new BayamFrontCom(this.id); // instanciate the Api once, as part of your init routine\n            this._bayamFrontCom.onPause(() => this.jx.pauseApplication());\n            this._bayamFrontCom.onResume(() => this.jx.resumeApplication());\n            // register once for receiving CLOSE request, as part of your init routine\n            this._bayamFrontCom.onClose(() => {\n                console.log(\"OnClose\");\n                this.onClose();\n            });\n            function onReady(event) {\n                console.log(\"onReady\", event);\n                var clientContext = event.data; //ex: ex: {support:desktop/mobile/browser, useragent:(navigator.userAgent), platform:(navigator.userAgent), age:3}\n                // startMyGame();\n            }\n            // register once for receiving READY request, as part of your init routine\n            // You will receive an event as a param of your callback fct, with data clientContext: ex: {support:desktop/mobile/browser, useragent:(navigator.userAgent), platform:(navigator.userAgent), age:3} \n            this._bayamFrontCom.onReady(onReady);\n            function onVolumeChange(event) {\n                alert(\"onVolumeChange\");\n                console.log(\"onVolumeChange\", event.data);\n                var volume = event.data; // ex: 0.2 (float)\n                // setMyVolume(volume);\n            }\n            // register once for receiving READY request, as part of your init routine\n            this._bayamFrontCom.onVolumeChange(onVolumeChange);\n            this.jx._bayamFrontCom = this._bayamFrontCom;\n            // this._bayamFrontCom.onReady(evt=>{\n            // \tconsole.log(\"_bayamFrontCom\", evt)});\n            // ----------------------------------------------------------------------------------------------\n            // 6-Register to receive READY event (triggered when iFrame is ready after fade in)\n            // ----------------------------------------------------------------------------------------------\n            // function onReady()\n            // {\n            // \t// startMyGame();\n            // }\n            // // register once for receiving READY request, as part of your init routine\n            // this._bayamFrontCom.onReady(onReady);\n        }\n        onInitialised();\n    }\n    saveSnapshot({ x = 0, y = 0, width, height, outputWidth, onfinished = evt => { } }) {\n        this.stage._stage.cache(x, y, width, height, outputWidth ? outputWidth / width : 1);\n        if (this.jx.config.system.container.type === \"bayam\") {\n            this.jx.saveImageToGallery({ img: this.stage._stage.getCacheDataURL(),\n                onsuccess: (evt) => {\n                    console.log(\"onsuccess\", evt);\n                    onfinished({ success: true });\n                },\n                onfail: (evt) => {\n                    console.log(\"onfail\", evt);\n                    onfinished({ success: false });\n                }\n            });\n            this.stage._stage.uncache();\n        }\n        else {\n            window.open(this.stage._stage.getCacheDataURL(), \"\");\n            this.stage._stage.uncache();\n            onfinished({ success: true });\n        }\n    }\n    /**\n     * Save an image data string to available gallery.\n     * @param  {string} options.img  data string png64\n     * @param  {json} options.desc\n     * @param  {function} options.onfinished\n     */\n    saveImageToGallery({ img, desc = null, onfinished = evt => { } }) {\n        if (this.jx.config.system.container.type === \"bayam\") {\n            this._bayamFrontCom.sendCreation(img, desc, evt => {\n                onfinished({ success: true });\n            }, evt => {\n                onfinished({ success: true });\n            });\n        }\n        else if (this.jx.config.system.container.type === \"azoomee\") {\n            let imageData = img.replace(/^data:image\\/(png|jpg);base64,/, '');\n            parent.postMessage({ method: \"saveImage\", responseID: \"optionnalID\", imageData: imageData }, \"*\");\n        }\n        else {\n            //  window.open(img, \"\"); // not working anymore in google chrome (directimage url not allowed now: https://groups.google.com/a/chromium.org/forum/#!topic/blink-dev/GbVcuwg_QjM%5B101-125%5D)\n            // then now, need iframe:\n            var iframe = \"<iframe frameBorder='0' width='2000px' height='2000px' onload='this.style.height=this.contentDocument.body.scrollHeight +\\'px\\';' src='\" + img + \"'></iframe>\";\n            var x = window.open();\n            x.document.open();\n            x.document.write(iframe);\n            x.document.close();\n            onfinished({ success: true });\n        }\n    }\n    save() {\n        // this._bayamFrontCom.sendKeyValue('level', 2, \n        // \tevt=>{\n        // \t},\n        // \tevt=>{\n        // \t}\n        // );\n    }\n    load() {\n        // this._bayamFrontCom.getKeyValue('level', \n        // \tevt=>{\n        // \t\tconsole.log('success '+evt.type);\n        // \t}, \n        // \tevt=>{ \n        // \t\tconsole.error(\"fail\", evt.errorId, evt.type);\n        // \t}\n        // ); \n    }\n    /**\n     * play a sound with zap possibility.\n     */\n    preloadSound({ id, onfinished = evt => { } }) {\n        let resource = this.jx.db.findOne({ id: id });\n        if (resource.data != null) {\n            onfinished({ resource: resource });\n        }\n        else if (resource.loader != null) {\n            resource.loader.onloaded.addOnce(evt => onfinished({ resource: resource }));\n        }\n        else {\n            let loader = new SoundLoader(resource, evt => {\n                onfinished({ resource: resource });\n            }, this.jx);\n            loader.load();\n        }\n    }\n    /**\n     * play a sound with zap possibility.\n     */\n    playSound({ id, zap = false, onfinished = evt => { } }) {\n        this.preloadSound({ id, onfinished: ({ resource }) => {\n                var player = this.jx.dj.createPlayer({ id: resource.id, streaming: true });\n                player.play({ id: resource.id, onfinished: onfinished });\n                let endFunc = evt => {\n                    player.cancel();\n                    this.jx.unblockInteractivity();\n                    onfinished();\n                };\n                if (zap) {\n                    this.jx.blockInteractivity(endFunc);\n                }\n            } });\n    }\n    /**\n     * play a comment with zap possibility.\n     */\n    playComment({ id, zap = false, onfinished = evt => { } }) {\n        var endFunc = evt => {\n            this.jx.dj.voice.cancel();\n            if (zap)\n                this.jx.unblockInteractivity();\n            onfinished();\n        };\n        this.jx.dj.voice.play({ id: id, onfinished: endFunc });\n        if (zap) {\n            this.jx.blockInteractivity(endFunc);\n        }\n    }\n    _logTimingHTML() {\n        var result = \"<br> >> TIMING LOG << <br>\";\n        var firstTime, lastTime;\n        for (var i = 0; i < window.jxTiming.length; i++) {\n            for (var prop in window.jxTiming[i]) {\n                if (i == 0) {\n                    firstTime = lastTime = window.jxTiming[i][prop];\n                }\n                result += \"<br>\" + prop + \": \" + (window.jxTiming[i][prop] - firstTime) / 1000 + \" (\" + (window.jxTiming[i][prop] - lastTime) / 1000 + \")\";\n                lastTime = window.jxTiming[i][prop];\n                break;\n            }\n        }\n        result += \"<br> >>>>>>>><<<<<<<< <br>\";\n        console.log(result);\n        return result;\n    }\n    _logTiming() {\n        var result = \"\\n >> TIMING LOG << \\n\";\n        var firstTime, lastTime;\n        for (var i = 0; i < window.jxTiming.length; i++) {\n            for (var prop in window.jxTiming[i]) {\n                if (i == 0) {\n                    firstTime = lastTime = window.jxTiming[i][prop];\n                }\n                result += \"\\n\" + prop + \": \" + (window.jxTiming[i][prop] - firstTime) / 1000 + \" (\" + (window.jxTiming[i][prop] - lastTime) / 1000 + \")\";\n                lastTime = window.jxTiming[i][prop];\n                break;\n            }\n        }\n        result += \"\\n >>>>>>>><<<<<<<< \\n\";\n        console.log(result);\n        return result;\n    }\n}\n"]}