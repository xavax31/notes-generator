{"version":3,"sources":["../../../../src/jx/core/presets/Module.js"],"names":["Module","dataObject","resourceClassesArray","modules","Array","onInitialised","typeID","jx","db","importConfig","importData","_prepareModule","console","log","projectInformations","config","setProjectInfo","i","resources","length","id","lang","langs","value","split","trim","addResources","concat","memo","addMemo","type","autosave","debug","init","load","_init","callback","start","onStarted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAEqBA,M;;;AAEjB,wBAAYC,UAAZ,EAAwB;AAAA;;AAAA,wHACdA,UADc;;AAIpB,kBAAKC,oBAAL,GAA4BD,WAAWC,oBAAvC;AACA,kBAAKC,OAAL,GAAe,IAAIC,KAAJ,EAAf;AACA,kBAAKC,aAAL,GAAqBJ,WAAWI,aAAhC;;AAGA,gBAAIC,SAAS,YAAb;AACA,kBAAKC,EAAL,CAAQC,EAAR,CAAWC,YAAX,CAAwBH,MAAxB,EAAgC,UAACI,UAAD,EAAgB;AAE5C,sBAAKA,UAAL,GAAkBA,UAAlB;AACA,sBAAKC,cAAL;AACH,aAJD;AAVoB;AAevB;;;;6CACgB;AAAA;;AACbC,wBAAQC,GAAR,CAAY,SAAZ,EAAuB,KAAKH,UAAL,CAAgBI,mBAAvC;AACA,qBAAKP,EAAL,CAAQQ,MAAR,CAAeC,cAAf,CAA8B,KAAKN,UAAL,CAAgBI,mBAA9C;;AAEA,qBAAK,IAAIG,IAAI,CAAb,EAAgBA,IAAI,KAAKP,UAAL,CAAgBQ,SAAhB,CAA0BC,MAA9C,EAAsDF,GAAtD,EAA2D;AACvD,wBAAI,KAAKP,UAAL,CAAgBQ,SAAhB,CAA0BD,CAA1B,EAA6BG,EAA7B,IAAmC,SAAvC,EAAkD;AAC9C,4BAAIC,OAAO,KAAKX,UAAL,CAAgBQ,SAAhB,CAA0BD,CAA1B,CAAX;AACA,4BAAIK,QAAQD,KAAKE,KAAL,CAAWC,KAAX,CAAiB,GAAjB,CAAZ;AACA,6BAAK,IAAIP,IAAI,CAAb,EAAgBA,IAAIK,MAAMH,MAA1B,EAAkCF,GAAlC,EAAuC;AACnCK,kCAAML,CAAN,IAAWK,MAAML,CAAN,EAASQ,IAAT,EAAX;AACH;AACD;AACA,4BAAIH,MAAMH,MAAN,GAAe,CAAnB,EAAsB;AAClB,iCAAKZ,EAAL,CAAQQ,MAAR,CAAeO,KAAf,GAAuBA,KAAvB;AACA,iCAAKf,EAAL,CAAQQ,MAAR,CAAeM,IAAf,GAAsBC,MAAM,CAAN,CAAtB;AACH;AACD;AACA;AACH;AACJ;AACD;AACAV,wBAAQC,GAAR,CAAYS,KAAZ;;AAWA,qBAAKf,EAAL,CAAQC,EAAR,CAAWkB,YAAX,CAAwB,KAAKhB,UAAL,CAAgBQ,SAAhB,CAA0BS,MAA1B,CAAiC,KAAKzB,oBAAtC,CAAxB;AACA,qBAAKK,EAAL,CAAQqB,IAAR,CAAaC,OAAb,CAAqB,EAAET,IAAI,QAAN,EAArB;AACA,qBAAKb,EAAL,CAAQqB,IAAR,CAAaC,OAAb,CAAqB,EAAET,IAAI,QAAN,EAAgBU,MAAM,QAAtB,EAAgCC,UAAU,IAA1C,EAArB;AACA,qBAAKxB,EAAL,CAAQyB,KAAR,CAAcC,IAAd;;AAEA,qBAAK1B,EAAL,CAAQC,EAAR,CAAW0B,IAAX,CAAgB,EAAE,QAAQ,OAAV,EAAhB,EAAqC,YAAM;AAGvC,2BAAK3B,EAAL,CAAQC,EAAR,CAAW0B,IAAX,CAAgB,EAAE,WAAW,IAAb,EAAhB,EAAqC,YAAM;AAEvC,+BAAKC,KAAL;AACH,qBAHD;AAIH,iBAPD;AAQH;;;iCACIC,Q,EAAU;AAAA;;AACX,qBAAK7B,EAAL,CAAQQ,MAAR,CAAekB,IAAf;AACA,qBAAKA,IAAL,CAAU,EAAE5B,eAAe,yBAAM;AAGzB,+BAAKgC,KAAL,CAAW,EAAEC,WAAW,qBAAM;AAGtB,uCAAKjC,aAAL;AACH,6BAJM,EAAX;AAKH,qBARK,EAAV;AASH;;;;;;sBA3EgBL,M","file":"Module.js","sourcesContent":["import Component from \"jx/core/comps/Component\";\n//import DocumentView from \"jx/comps/DocumentView\";\nexport default class Module extends Component {\n    // constructor ({jx=null, debug = false, yop=\"hep\", onInitialised, resourceClassesArray}) {\n    constructor(dataObject) {\n        super(dataObject);\n        //console.log(this)\n        // this.jx.global.debug.logTime(\"Module constructor\", this.id || \"Module\");\n        this.resourceClassesArray = dataObject.resourceClassesArray;\n        this.modules = new Array();\n        this.onInitialised = dataObject.onInitialised;\n        //--- Get Comprehensive data from importer of type typeID (cf dir jx/projecttypes/).\n        // importData retrieved by importer must be of type dataobjects/ImportData\n        var typeID = \"SimpleJSON\";\n        this.jx.db.importConfig(typeID, (importData) => {\n            // this.jx.global.debug.logTime(\"Module Config loaded\", this.id || \"Module\");\n            this.importData = importData;\n            this._prepareModule();\n        });\n    }\n    _prepareModule() {\n        console.log(\"prepare\", this.importData.projectInformations);\n        this.jx.config.setProjectInfo(this.importData.projectInformations);\n        //this.jx.styles.addStyles(this.importData.styles);\n        for (var i = 0; i < this.importData.resources.length; i++) {\n            if (this.importData.resources[i].id == \"Langues\") {\n                var lang = this.importData.resources[i];\n                var langs = lang.value.split(\",\");\n                for (var i = 0; i < langs.length; i++) {\n                    langs[i] = langs[i].trim();\n                }\n                ;\n                if (langs.length > 0) {\n                    this.jx.config.langs = langs;\n                    this.jx.config.lang = langs[0];\n                }\n                ;\n                break;\n            }\n        }\n        ;\n        console.log(langs);\n        // if(lang && lang.data){\n        // \tvar langs = lang.data.split(\",\");\n        // \tfor (var i = 0; i < langs.length; i++) {\n        // \t\tlangs[i] = langs[i].trim();\n        // \t};\n        // \tif (langs.length>0) {\n        // \t\tthis.jx.config.langs = langs;\n        // \t\tthis.jx.config.lang = langs[0];\n        // \t};\n        // }\n        this.jx.db.addResources(this.importData.resources.concat(this.resourceClassesArray));\n        this.jx.memo.addMemo({ id: \"global\" });\n        this.jx.memo.addMemo({ id: \"cookie\", type: \"Cookie\", autosave: true });\n        this.jx.debug.init();\n        // Load Classes first\n        this.jx.db.load({ \"type\": \"class\" }, () => {\n            //--- load resources\n            // this.jx.global.debug.logTime(\"Module Classes loaded\", this.id || \"Module\");\n            this.jx.db.load({ \"preload\": true }, () => {\n                // this.jx.global.debug.logTime(\"Module Resources loaded\", this.id || \"Module\");\n                this._init();\n            });\n        });\n    }\n    init(callback) {\n        this.jx.config.init();\n        this.init({ onInitialised: () => {\n                //console.log(\"Module initialised\");\n                // this.jx.global.debug.logTime(\"Module initialised\", this.id || \"Module\");\n                this.start({ onStarted: () => {\n                        // this.jx.global.debug.logTime(\"Module started\", this.id || \"Module\");\n                        // this.jx.global.loadingScreen.hide();\n                        this.onInitialised(this);\n                    } });\n            } });\n    }\n}\n"]}