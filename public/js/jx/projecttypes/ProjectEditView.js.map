{"version":3,"sources":["../../../src/jx/projecttypes/ProjectEditView.js"],"names":["ProjectEditView","dataObject","console","log","addEventDispatcher","_createPage","view","$","html","project","info","title","trim","id","editMenu","jx","editor","user","name","group","append","find","on","evt","target","value","lang","refreshEditionView","editionItemGenerator","modeDisplay","setFilters","css","hasAccess","buttons","i","length","click","event","currentTarget","attr","request","JSON","parse","action","params","undefined","actionArr","split","targetFunc","call","readMode","hideInfo","_setRemoteDeamon"],"mappings":"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","file":"ProjectEditView.js","sourcesContent":["import Component from \"jx/core/comps/Component\";\nexport default class ProjectEditView extends Component {\n    constructor(dataObject) {\n        super(dataObject);\n    }\n    _create() {\n        console.log(\"ProjectEditView create\");\n        this.addEventDispatcher(\"onevent\");\n        this._createPage();\n    }\n    _createPage() {\n        //console.log(\"createPage\")\n        this.view = $(\"body\");\n        //alert(this.project.info.title)\n        $('title').html((this.project.info.title && this.project.info.title.trim() != \"\") ? this.project.info.title : this.project.info.id);\n        //________________________\n        // TOP MENU\n        let editMenu = $(`\n\t\t\t<div>\n\t\t\t\t<h4 id=\"idProject\" class=\"text-center\"></h4>\n\n\t\t\t\t<div  class=\"text-right\" style=\"top:0px;right: 0px;position:absolute\">\n\t\t\t\t\t<span class=\"fa fa-user\">${this.jx.editor.user.name}</span><span>(${this.jx.editor.user.group})</span>\n\t          \t</div>\n\n\t\t\t\t<div  id=\"edit_menu\" class=\"text-right\">\n\t\t\t\t\t<select id=\"Lang\" class=\"inline\">\n\t\t\t\t\t    <option value=\"fr\">Français</option>\n\t\t\t\t\t    <option value=\"en\">Anglais</option>\n\t\t\t\t\t    <option value=\"de\">Allemand</option>\n\t\t\t\t\t    <option value=\"es\">Espagnol</option>\n\t\t\t\t\t    <option value=\"it\">Italien</option>\n\t\t\t\t\t</select>\n\t\t\t\t\t<select id=\"TypeView\" class=\"inline\">\n\t\t\t\t\t    <option value=\"tab\">Vue onglets</option>\n\t\t\t\t\t    <option value=\"flat\">Vue à plat</option>\n\t\t\t\t\t</select>\n\t\t\t\t\t<select id=\"TypeSelection\" class=\"inline\">\n\t\t\t\t\t    <option value='{\"type\":\"all\"}'>Tout afficher</option>\n\t\t\t\t\t    <option value='{\"type\":\"sound\"}'>Afficher que les sons</option>\n\t\t\t\t\t    <option value='{\"type\":\"text\"}'>Afficher que les texts</option>\n\t\t\t\t\t    <option value='{\"type\":\"image\"}'>Afficher que les images</option>\n\t\t\t\t\t</select>\n\n\t\t\t\t\t<div id=\"drop_zone\"></div>\n\t\t\t\t\t\n\t\t\t\t  \n\t\t\t\t  \t<button type=\"button\"  id=\"report\" class=\"btn btn-default\"  title=\"Génerer un rapport du projet\"><span class=\"fa fa-list\"></span></button>\n\t\t\t\t  \t<button type=\"button\"  id=\"sendMail\" class=\"btn btn-default\"  title=\"Prévenir le développeur d'une demande de modification\"><span class=\"fa fa-envelope-o\"></span></button>\n\n\t\t\t\t  \t<div class=\"btn-group\">\n\t\t\t\t  \t\t<button type=\"button\" id=\"openProjectDir\" data-action='{\"action\": \"project.openProjectDir\"}'  class=\"btn btn-default\"  title=\"Explorer le dossier local du projet\"><span class=\"fa fa-folder-open-o\"></button>\n\t\t\t\t\t  \t<button type=\"button\" id=\"pullProject\" data-action='{\"action\": \"project.pullProject\"}' class=\"btn btn-default\"  title=\"Pousse le projet sur le serveur\">Pull</button>\n\t\t\t\t\t  \t<button type=\"button\" id=\"pushProject\" data-action='{\"action\": \"project.pushProject\"}' class=\"btn btn-default\"  title=\"Tire le projet du serveur\">Push</button>\n\t\t\t\t\t  \t<button type=\"button\" id=\"pushProjectSrc\" data-action='{\"action\": \"project.pushProjectSrc\"}' class=\"btn btn-default\"  title=\"Pousse uniquement le code sur le serveur\">Push <span class=\"fa fa-file-code-o\"></span></button>\n\t\t\t\t\t  \t<button type=\"button\" id=\"transpilProject\"  data-action='{\"action\": \"project.transpilProject\"}' class=\"btn btn-default\"  title=\"Lance la transpilation es6 Babel dans un terminal\"><span class=\"fa fa-cogs\"></span></button>\n\t\t\t\t\t  </div>\n\t\t\t\t  \t\n\t\t\t\t  \t<div class=\"btn-group\">\n\t\t\t\t  \t\t<button type=\"button\" id=\"editGabarit\" class=\"btn btn-default\"  title=\"Editer le gabarit\"><span class=\"fa fa-sitemap\"></span></button>\n\t\t\t\t  \t\t<button type=\"button\" id=\"save\" class=\"btn btn-default\" title=\"Sauver les modifications\"><span class=\"fa fa-floppy-o\"></span></button>\n\t\t\t\t  \t</div>\n\n\t\t\t\t  \t<div class=\"btn-group\">\n\t\t\t\t\t  \t<button type=\"button\" id=\"previewDev\" data-action='{\"action\": \"project.previewDev\"}' class=\"btn btn-default\"  title=\"Voir l'aperçu de ce projet utilisant la dernière version de jxengine\"  style=\"color:#000000;background-color:#ff8a2d\" >jx<span class=\"fa fa-bug\"></span></button>\n\n\t\t\t\t  \t\t<button type=\"button\" id=\"updateInternJXDialog\"  data-action='{\"action\": \"project.updateInternJXDialog\"}' class=\"btn btn-default\" title=\"Met à jour ce projet avec la dernière version de jxengine\">jx<span class=\"fa fa-level-up\"></span></button>\n\t\t\t\t  \t</div>\n\n\t\t\t\t  \t<div class=\"btn-group\" style=\"margin-left: 50px;\">\n\t\t\t\t  \t</div>\n\n\n\t\t\t\t\t<button type=\"button\"  id=\"exportDial\"   data-action='{\"action\": \"project.exportDial\"}' class=\"btn btn-default\"  title=\"Exporter/Télécharger une version du projet\"><span class=\"fa fa-share-square-o\"></span></button>\n\n\t\t\t\t\t<button type=\"button\" id=\"showInfo\" class=\"btn btn-default\" title=\"Show/Hide info\"><span class=\"fa fa-info\"></span></button>\n\t\t\t\t\t<button type=\"button\" id=\"hideInfo\" class=\"btn btn-default active\" title=\"Show/Hide info\"><span class=\"fa fa-info\"></span></button>\n\n\t\t\t\t\t<button type=\"button\" id=\"editMode\" class=\"btn btn-default btn-lg\" style=\"color:#FFFFFF;background-color:#4d90fe\" title=\"Editer\"><span class=\"fa fa-pencil\">Editer</span></button>\n\t\t\t\t\t<button type=\"button\" id=\"readMode\" class=\"btn btn-danger btn-lg active\"  style=\"color:#FFFFFF;background-color:#D94A38\" title=\"Sortir du mode édition\"><span class=\"fa fa-check\">Terminer</span></button>\n\n\t\t\t\t\t<button type=\"button\" id=\"preview\"   data-action='{\"action\": \"project.preview\"}' class=\"btn btn-default  btn-lg\"  title=\"Voir l'aperçu\"  style=\"color:#000000;background-color:#27fd00\" ><span class=\"fa fa-eye\"></span></button>\n\t\t\t\t\t<button type=\"button\" id=\"previewDebug\"   data-action='{\"action\": \"project.previewDebug\"}' class=\"btn btn-default  btn-lg\"  title=\"Voir l'aperçu (mode debug)\" style=\"color:#000000;background-color:#ff8a2d\" ><span class=\"fa fa-bug\"></span></button>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`);\n        this.editMenu = editMenu;\n        this.view.append(editMenu);\n        editMenu.find(\"#Lang\").on(\"change\", evt => {\n            console.log(\"change\", evt.target.value);\n            this.lang = evt.target.value;\n            this.refreshEditionView();\n        });\n        editMenu.find(\"#TypeView\").on(\"change\", evt => {\n            console.log(\"change\", evt.target.value);\n            this.editionItemGenerator.modeDisplay = evt.target.value;\n            this.refreshEditionView();\n        });\n        editMenu.find(\"#TypeSelection\").on(\"change\", evt => {\n            console.log(\"change\", evt.target.value);\n            this.editionItemGenerator.setFilters(evt.target.value);\n            this.refreshEditionView();\n        });\n        //editMenu.find(\"#idProject\").html(this.project.info.id);\n        editMenu.find(\"#idProject\").html((this.project.info.title && this.project.info.title.trim() != \"\") ? this.project.info.title : this.project.info.id);\n        editMenu.find(\"#sendMail\").css('display', \"none\");\n        editMenu.find(\"#report\").css('display', \"none\");\n        editMenu.find(\"#editGabarit\").css('display', (this.hasAccess(\"editGabarit\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#openProjectDir\").css('display', (this.hasAccess(\"openProjectDir\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#pullProject\").css('display', (this.hasAccess(\"pullProject\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#pushProject\").css('display', (this.hasAccess(\"pushProject\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#pushProjectSrc\").css('display', (this.hasAccess(\"pushProjectSrc\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#transpilProject\").css('display', (this.hasAccess(\"transpilProject\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#previewDev\").css('display', (this.hasAccess(\"previewDev\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#updateInternJXDialog\").css('display', (this.hasAccess(\"updateInternJX\") ? \"inline\" : \"none\"));\n        editMenu.find(\"#save\").css('display', (this.hasAccess(\"save\") ? \"inline\" : \"none\"));\n        //--- add click on buttons. If attribute \"data-action\" is defined, click calls this[data-action](), else it calls this[btnID]()\n        var buttons = editMenu.find(\".btn\");\n        for (var i = 0; i < buttons.length; i++) {\n            $(buttons[i]).click((event) => {\n                if ($(event.currentTarget).attr(\"data-action\")) {\n                    var request = JSON.parse($(event.currentTarget).attr(\"data-action\"));\n                }\n                else {\n                    request = { action: event.currentTarget.id, params: undefined };\n                }\n                var action = request.action;\n                var params = request.params || undefined;\n                var actionArr = action.split(\".\");\n                var targetFunc = this;\n                var target = this;\n                for (var i = 0; i < actionArr.length; i++) {\n                    target = targetFunc;\n                    targetFunc = targetFunc[actionArr[i]];\n                }\n                ;\n                console.log(action, params);\n                targetFunc.call(target, params);\n            });\n        }\n        ;\n        this.refreshEditionView();\n        this.readMode();\n        this.hideInfo();\n        this._setRemoteDeamon();\n    }\n}\n"]}