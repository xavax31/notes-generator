{"version":3,"sources":["../../../../src/jx/comps/screensmanager/ScreenPhoto.js"],"names":["ScreenPhoto","dataObject","Object","assign","sClose","type","rid","resourceID","nextScreenID","cadre","callback","_showImage","id","onmousedown","jx","dj","play","app","screens","go","onready","view","evt","target","stage","removeChild","image","killme","resource","db","findOne","console","error","showImageFunc","img","cc","comps","remove","addChild","fitIn","center","setChildIndex","getChildIndex","photoHolder","addOnce","data","load"],"mappings":"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","file":"ScreenPhoto.js","sourcesContent":["import Component from \"jx/core/comps/Component\";\n/**\n */\nexport default class ScreenPhoto extends Component {\n    constructor(dataObject) {\n        super(Object.assign({\n            sClose: null,\n        }, dataObject));\n    }\n    _create() {\n        super._create();\n        this.type = \"image\";\n        this.rid = this.dataObject.rid || this.dataObject.resourceID;\n        this.nextScreenID = this.dataObject.nextScreenID;\n        this.cadre = this.dataObject.cadre;\n    }\n    show(callback = evt => { }) {\n        this._showImage({ id: this.rid, cadre: this.cadre,\n            onmousedown: evt => {\n                if (this.dataObject.sClose)\n                    this.jx.dj.play({ id: this.dataObject.sClose });\n                this.jx.app.screens.go(this.nextScreenID);\n            },\n            onready: evt => {\n                this.view = evt.target;\n                callback({ target: this });\n            }\n        });\n    }\n    hide(evt) {\n        if (this.view) {\n            this.jx.app.stage.removeChild(this.cadre);\n            this.cadre.removeChild(this.image);\n            this.image.killme();\n            this.image = null;\n        }\n    }\n    _showImage({ id, onmousedown = evt => { }, onready = evt => { }, cadre = null }) {\n        var resource = this.jx.db.findOne({ id });\n        if (!resource) {\n            console.error(\"Image \", id, \"not found in db\");\n        }\n        ;\n        var showImageFunc = evt => {\n            var img = this.cc({ rid: id });\n            img.killme = () => {\n                this.comps.remove(img);\n            };\n            this.jx.app.stage.addChild(cadre);\n            cadre.addChild(img);\n            img.fitIn({ target: this.jx.app.stage, center: true });\n            cadre.setChildIndex(img, cadre.getChildIndex(cadre.photoHolder));\n            cadre.onmousedown.addOnce(onmousedown);\n            this.image = img;\n            onready({ target: cadre, image: img });\n        };\n        if (!resource.data) {\n            this.jx.db.load({ id }, showImageFunc);\n        }\n        else {\n            showImageFunc();\n        }\n    }\n}\n"]}