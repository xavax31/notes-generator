{"version":3,"sources":["../../../../src/jx/comps/video/VideoDOM.js"],"names":["VideoDOM","dataObject","Object","assign","videoResource","resourceID","initialise","loops","fadeOut","delay","enabled","volume","oninitialised","_initSteps","sourceAdded","metaDataLoaded","canPlay","canPlayThrough","jx","db","findOne","id","src","video","document","createElement","setAttribute","className","preload","loop","view","$","_loops","frame","framerate","_playing","addEventDispatcher","css","prop","_addInitListeners","_source","_ready","append","getAttribute","console","warn","log","setResource","play","callback","pause","currentTime","_appFreezed","_stateBeforeFreeze","playing","resume","target","onloadedinfos","addOnce","unload","onplay","removeAll","onseeked","onstalled","onpaused","onstopped","onwaiting","onplaying","onfinished","onprogress","oncanplaythrough","children","remove","length","on","event","videoWidth","videoHeight","duration","width","height","fitIn","dispatch","oncanplay","time","_volumeDefined","value","playbackRate","muted"],"mappings":"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","file":"VideoDOM.js","sourcesContent":["import VisualComponentDOM from \"jx/comps/visualcomponent/VisualComponentDOM\";\nexport default class VideoDOM extends VisualComponentDOM {\n    constructor(dataObject) {\n        super(Object.assign({\n            videoResource: null,\n            resourceID: null,\n            initialise: false,\n            loops: 0,\n            fadeOut: Object.assign({ delay: 100, enabled: false }, dataObject.fadeOut || {}),\n            volume: 1,\n            oninitialised: evt => { }\n        }, dataObject));\n    }\n    _create() {\n        super._create();\n        this._initSteps = {\n            sourceAdded: false,\n            metaDataLoaded: false,\n            canPlay: false,\n            canPlayThrough: false\n        };\n        if (this.dataObject.resourceID != null) {\n            this.videoResource = this.jx.db.findOne({ id: this.dataObject.resourceID });\n        }\n        else if (this.dataObject.videoResource != null) {\n            this.videoResource = this.dataObject.videoResource;\n        }\n        else if (this.dataObject.src != null) {\n            this.videoResource = { src: this.dataObject.src };\n        }\n        else {\n            //console.error(\"videoResource or resourceID needed for Video component\");\n        }\n        var video = document.createElement('video');\n        video.setAttribute('playsinline', '');\n        video.setAttribute('webkit-playsinline', '');\n        video.className = \"video\";\n        video.preload = \"auto\";\n        video.loop = false;\n        this.view = $(video);\n    }\n    _initSync() {\n        super._initSync();\n        this.loops = this.dataObject.loops;\n        this._loops = this.loops;\n        this.frame = 0;\n        this.framerate = 12;\n        this.fadeOut = this.dataObject.fadeOut;\n        this.volume = this.dataObject.volume;\n        this._playing = false;\n        this.addEventDispatcher(\"onplay\", \"onseeked\", \"onstalled\", \"onpaused\", \"onstopped\", \"onwaiting\", \"onplaying\", \"onfinished\", \"onloadedinfos\", \"onprogress\", \"oncanplay\", \"oncanplaythrough\");\n        this.view.css(\"position\", \"absolute\");\n        this.view.css(\"left\", \"0px\");\n        this.view.css(\"top\", \"0px\");\n        this.view.css(\"object-fit\", \"fill\");\n        this.view.prop(\"controls\", false);\n        this._addInitListeners();\n    }\n    setResource({ src = null } = {}) {\n        src = src || (this.videoResource ? this.videoResource.src : null);\n        //console.log(\"setResource\", src);\n        if (src) {\n            if (!this._source) {\n                this._ready = false;\n                this._source = document.createElement('source');\n                this._source.setAttribute(\"src\", src);\n                this._source.setAttribute(\"type\", 'video/mp4; codecs=avc1.42E01E,mp4a.40.2');\n                this.view.append(this._source);\n            }\n            else if (this._source.getAttribute(\"src\") != src) {\n                this._ready = false;\n                this._source.setAttribute(\"src\", src);\n            }\n        }\n        else {\n            console.warn(\"No video resource provided\");\n        }\n    }\n    play() {\n        console.log(\"Play Video\", this.id);\n        this.setResource();\n        //  this._volumeRestore();\n        this.view[0].play();\n        this._playing = true;\n    }\n    stop({ callback } = { callback: null }) {\n        if (!this._playing)\n            return;\n        console.log(\"stop\", this.id);\n        this.view[0].pause();\n        this.view[0].currentTime = 0;\n        this._loops = this.loops;\n        // var fade = (this.fadeOut.enabled ? this.fadeOut.delay : 0);\n        // this.view.animate(\n        // \t{ volume: 0 }, // Target volume\n        // \tfade, // How long should the fadeout take\n        // \t()=>{\n        // \t\tthis.view[0].pause();\n        // \t\tthis.view[0].currentTime = 0;\n        // \t\tif (callback) callback({target:this});\n        // \t}\n        // );\n    }\n    pause() {\n        if (!this._playing)\n            return;\n        this._playing = false;\n        this.view[0].pause();\n    }\n    resume() {\n        console.log(\"resume\", this._playing);\n        if (this._playing)\n            return;\n        this._playing = true;\n        this.view[0].play();\n    }\n    get playing() {\n        return this._playing;\n    }\n    appFreeze() {\n        console.log(\"freeze\", this._playing);\n        if (this._appFreezed)\n            return false;\n        this._stateBeforeFreeze = { playing: this._playing };\n        this.pause();\n        super.appFreeze();\n    }\n    appUnfreeze() {\n        console.log(\"unfreeze\", this);\n        if (!this._appFreezed)\n            return false;\n        if (this._stateBeforeFreeze.playing) {\n            this.resume();\n        }\n        ;\n        super.appUnfreeze();\n    }\n    init(callback = evt => { }) {\n        if (this._ready) {\n            callback({ target: this });\n            return;\n        }\n        ;\n        //console.log(\"video-init\", this.videoResource.src);\n        this.onloadedinfos.addOnce(evt => {\n            this._ready = true;\n            callback({ target: this });\n        });\n        this.setResource({ src: this.videoResource.src });\n    }\n    kill(unload = true) {\n        if (!this.jx)\n            return;\n        this.onplay.removeAll();\n        this.onseeked.removeAll();\n        this.onstalled.removeAll();\n        this.onpaused.removeAll();\n        this.onstopped.removeAll();\n        this.onwaiting.removeAll();\n        this.onplay.removeAll();\n        this.onplaying.removeAll();\n        this.onfinished.removeAll();\n        this.onprogress.removeAll();\n        this.oncanplaythrough.removeAll();\n        this.view[0].pause();\n        this.view[0].src = \"\"; // empty source\n        //this.view[0].load();\n        this.view.children('source').prop('src', '');\n        this.view.remove().length = 0;\n        // if (unload) {\n        // \tthis.view[0].src = \"\";\n        // \tthis.view[0].load();\n        // }\n        this._source = null;\n        this.videoResource = null;\n        super.kill();\n    }\n    _addInitListeners() {\n        /*\n        > on ios and Android, all theses events fires only after a user click.\n\n        > fires when video.play is called. If called just after adding source to video, it fires before 'onloadstart'\n        play\n        waiting\n\n        > fires since the source is added to video, even if video preload=false and video not added to document\n        loadstart\n\n        progress (zero or many) others can appears between further events\n\n        loadedmetadata (width, height, duration of video can be catch since here)\n\n        > fires on mac/chrome,safari, android,\n        > fires after play call only, on ios (ipad3(ios9.3.5), IPAD air2(ios10.0.2))\n        loadeddata\n        canplay\n        canplaythrough\n\n        suspend (can be before canplaythrough)\n        stalled sometimes (mac/chrome)\n        \n        playing is fire only if play is called, seems be after canplaythroug for mac/safari and ios, but before for all others.\n\n\n        > during playing\n        timeupdate\n\n        > When video reaches end, on all devices\n        pause\n        end\n        */\n        this.view.on(\"loadstart\", (event) => {\n            //console.log(\"onloadstart\", this.id, event);     \n        });\n        this.view.on(\"loadedmetadata\", (event) => {\n            console.log(\"onloadedinfos\", this.id, \"infos video: \", this.view[0].videoWidth, \"x\", this.view[0].videoHeight, \",\", this.view[0].duration, \"s\");\n            this._initSteps.metaDataLoaded = true;\n            // super.width = this._wantedWidth;\n            this.view.css(\"width\", this.view[0].videoWidth + \"px\");\n            this.view.css(\"height\", this.view[0].videoHeight + \"px\");\n            if (this.dataObject.width)\n                this.width = this.dataObject.width;\n            if (this.dataObject.height)\n                this.height = this.dataObject.height;\n            if (this.dataObject.fitIn)\n                this.fitIn(this.dataObject.fitIn);\n            this.onloadedinfos.dispatch({ target: this });\n        });\n        this.view.on(\"loadeddata\", (event) => {\n            //console.log(\"onloadeddata\", this.id, event);   \n        });\n        //--- Next events fires when source is added to video.\n        this.view.on(\"progress\", (event) => {\n            //console.log(\"onprogress\", this.id, event);     \n            this.onprogress.dispatch({ target: this });\n        });\n        this.view.on(\"suspend\", (event) => {\n            //console.log(\"onsuspend\", this.id, event);     \n        });\n        this.view.on(\"canplay\", (event) => {\n            //console.log(\"oncanplay\", this.id, event);   \n            //console.log(\"infos video: \", this.view[0].videoWidth, this.view[0].videoHeight, this.view[0].duration);\n            this._initSteps.canPlay = true;\n            this.oncanplay.dispatch({ target: this });\n        });\n        this.view.on(\"canplaythrough\", (event) => {\n            //console.log(\"oncanplaythrough\", this.id, event);   \n            this._initSteps.canPlayThrough = true;\n            this.oncanplaythrough.dispatch({ target: this });\n        });\n        this.view.on(\"stalled\", (event) => {\n            //console.log(\"stalled\", this.id, event);     \n            this.onstalled.dispatch({ target: this });\n        });\n        //--- Events when play\n        this.view.on(\"timeupdate\", (event) => {\n            //this.onplay.dispatch({target:this})              \n        });\n        this.view.on(\"waiting\", (event) => {\n            //console.log(\"onwaiting\", this.id, event);     \n            this.onwaiting.dispatch({ target: this });\n        });\n        this.view.on(\"abort\", (event) => {\n            //console.log(\"onabort\", this.id, event);     \n        });\n        this.view.on(\"error\", (event) => {\n            console.log(\"onerror\", this.id, event);\n        });\n        this.view.on(\"seeked\", (event) => {\n            //console.log(\"onseeked\", this.id, event);     \n            this.onseeked.dispatch({ target: this });\n        });\n        this.view.on(\"seeking\", (event) => {\n            //console.log(\"onseeking\", this.id, event);     \n        });\n        this.view.on(\"play\", (event) => {\n            //console.log(\"onplay\", this.id);     \n            this.onplay.dispatch({ target: this });\n        });\n        this.view.on(\"playing\", (event) => {\n            console.log(\"onplaying\", this.id);\n            this.onplaying.dispatch({ target: this, time: this.view[0].currentTime });\n        });\n        this.view.on('ended', evt => {\n            //console.log(\"onended\", this.id);  \n            if (this._loops === -1) {\n                this.play();\n            }\n            else {\n                if (this._loops == 0) {\n                    console.log(\"onfinished\", this.id);\n                    this._playing = false;\n                    this.onfinished.dispatch({ target: this });\n                }\n                else {\n                    this._loops--;\n                    this.play();\n                }\n            }\n        });\n        this.view.on(\"pause\", (event) => {\n            //console.log(\"onpause\", this.id, event);     \n            this.onpaused.dispatch({ target: this });\n        });\n    }\n    // set width(value) {\n    // \tthis._wantedWidth = value;\n    // \tif (this._initSteps.metaDataLoaded) {\n    // \t\tsuper.width = this._wantedWidth;\n    // \t}\n    // }\n    get duration() {\n        return this.view[0].duration;\n    }\n    get currentTime() {\n        return this.view[0].currentTime;\n    }\n    set currentTime(value) {\n        this.view[0].currentTime = value;\n    }\n    //   pause({callback=null}={callback:null}) {\n    //   \tconsole.log(\"pause\", this.id);\n    //   \tvar fade = (this.fadeOut.enabled ? this.fadeOut.delay : 0);\n    //   \tif (fade) {\n    // \tthis.view.animate(\n    // \t\t{ volume: 0 }, // Target volume\n    // \t\tfade, // How long should the fadeout take\n    // \t\t()=>{\n    // \t\t\tthis.view[0].pause();\n    // \t\t\tif (callback) callback({target:this});\n    // \t\t}\n    // \t);\n    // }\n    // else {\n    // \tthis.view[0].pause();\n    // \tif (callback) callback({target:this});\n    // }\n    //   }\n    //  \tstop({callback}={callback:null}) {\n    //  \t\tconsole.log(\"stop\", this.id);\n    //  \t\tvar fade = (this.fadeOut.enabled ? this.fadeOut.delay : 0);\n    // this.view.animate(\n    // \t{ volume: 0 }, // Target volume\n    // \tfade, // How long should the fadeout take\n    // \t()=>{\n    // \t\tthis.view[0].pause();\n    // \t\tthis.view[0].currentTime = 0;\n    // \t\tif (callback) callback({target:this});\n    // \t}\n    // );\n    //   }\n    set playbackRate(value) {\n        this.view[0].playbackRate = value;\n    }\n    set volume(value) {\n        this.view[0].volume = value;\n        this._volumeDefined = value;\n    }\n    get volume() {\n        return this.view[0].volume;\n    }\n    /**\n     * Restore volume to last value defined.\n     * @private\n     */\n    _volumeRestore() {\n        this.volume = this._volumeDefined;\n    }\n    set muted(value) {\n        this.view[0].muted = value;\n    }\n    get muted() {\n        return this.view[0].muted;\n    }\n}\n"]}