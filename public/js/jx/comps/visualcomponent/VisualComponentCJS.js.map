{"version":3,"sources":["../../../../src/jx/comps/visualcomponent/VisualComponentCJS.js"],"names":["VisualComponentCJS","dataObject","_killed","view","_removeListeners","cacheCanvas","uncache","_jxClip","_addListeners","getTransformedBounds","par","x","y","_basicsListeners","onclick","on","_clicked","evt","_rollover","_rollout","_mouseup","_mousedown","_mousemove","off","onrollover","onrollout","onmouseup","onmousedown","onmousemove","Math","cos","rotation","PI","scale","quality","jx","config","flashOptimizer","resScreen","system","screen","resolutionUser","visualBounds","getBounds","stage","app","scaleW","width","scaleH","height","min","console","log","abs","scaleFactor","urlParams","undefined","bounds","nominalBounds","qualityFactor","window","devicePixelRatio","ratio","max","resolution","scaleX","scaleY","id","scaleTotal","warn","cache","error","updateCache","localToGlobal","globalToLocal","localToLocal","parent","setChildIndex","numChildren","oldRotation","value","actualWidth","actualHeight","mouseEnabled","_anchorX","regX","_anchorY","regY","anchorY","anchorX","_cursorOnRoll","_enabled","cursor","_cursorOnDisabled","_parent","mod","mixin"],"mappings":"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","file":"VisualComponentCJS.js","sourcesContent":["import VisualComponent from \"jx/core/comps/VisualComponent\";\nexport default class VisualComponentCJS extends VisualComponent {\n    constructor(dataObject) {\n        super(dataObject);\n    }\n    static initialiseMod(mod) {\n        mod.mixin([\"_addListeners\", \"_removeListeners\", \"width\", \"height\",\n            \"saveBounds\", \"cache\", \"localToGlobal\", \"globalToLocal\", \"localToLocal\"], VisualComponentCJS, \"VisualComponent\");\n    }\n    kill() {\n        if (this._killed)\n            return;\n        //this._parent = null;\n        if (this.view) {\n            this._removeListeners();\n            if (this.view.cacheCanvas) {\n                this.view.uncache();\n            }\n            ;\n        }\n        ;\n        super.kill();\n    }\n    _initSync() {\n        super._initSync();\n        if (!this.view)\n            return;\n        this.view._jxClip = this;\n        this._addListeners();\n    }\n    getLimits() {\n        return this.view.getTransformedBounds();\n    }\n    transform(par) {\n        this.view.x = par.x || this.view.x;\n        this.view.y = par.y || this.view.y;\n    }\n    get realWidth() {\n        let oldRotation = this.rotation;\n        this.rotation = 0;\n        let width = this.width;\n        this.rotation = oldRotation;\n        return width;\n    }\n    set realWidth(value) {\n        let oldRotation = this.rotation;\n        this.rotation = 0;\n        this.width = value;\n        this.rotation = oldRotation;\n    }\n    get realHeight() {\n        let oldRotation = this.rotation;\n        this.rotation = 0;\n        let height = this.height;\n        this.rotation = oldRotation;\n        return height;\n    }\n    set realHeight(value) {\n        let oldRotation = this.rotation;\n        this.rotation = 0;\n        this.height = value;\n        this.rotation = oldRotation;\n    }\n    set width(value) {\n        if (this.view.getTransformedBounds()) {\n            var actualWidth = this.view.getTransformedBounds().width;\n            var scaleX = this.view.scaleX;\n            var ratio = value / actualWidth;\n            this.view.scaleX *= ratio;\n        }\n    }\n    get width() {\n        if (this.view.getTransformedBounds()) {\n            return this.view.getTransformedBounds().width;\n        }\n        return 0;\n    }\n    set height(value) {\n        if (this.view.getTransformedBounds()) {\n            var actualHeight = this.view.getTransformedBounds().height;\n            var scaleY = this.view.scaleY;\n            var ratio = value / actualHeight;\n            this.view.scaleY *= ratio;\n        }\n    }\n    get height() {\n        if (this.view.getTransformedBounds()) {\n            return this.view.getTransformedBounds().height;\n        }\n        return 0;\n    }\n    /** @type {boolean} */\n    set enabled(value) {\n        super.enabled = value;\n        this.view.mouseEnabled = value;\n    }\n    /** @type {boolean} */\n    get enabled() {\n        return super.enabled;\n    }\n    _addListeners() {\n        if (!this.view)\n            return;\n        this._basicsListeners = this._basicsListeners || {};\n        this._removeListeners();\n        this._basicsListeners.onclick = this.view.on(\"click\", evt => this._clicked(evt));\n        this._basicsListeners._rollover = this.view.on(\"rollover\", evt => this._rollover(evt));\n        this._basicsListeners._rollout = this.view.on(\"rollout\", evt => this._rollout(evt));\n        this._basicsListeners._mouseup = this.view.on(\"pressup\", evt => this._mouseup(evt));\n        this._basicsListeners._mousedown = this.view.on(\"mousedown\", evt => this._mousedown(evt));\n        this._basicsListeners._mousemove = this.view.on(\"pressmove\", evt => this._mousemove(evt));\n    }\n    _removeListeners() {\n        if (!this.view)\n            return;\n        this._basicsListeners = this._basicsListeners || {};\n        this.view.off(\"click\", this._basicsListeners.onclick);\n        this.view.off(\"rollover\", this._basicsListeners.onrollover);\n        this.view.off(\"rollout\", this._basicsListeners.onrollout);\n        this.view.off(\"pressup\", this._basicsListeners.onmouseup);\n        this.view.off(\"mousedown\", this._basicsListeners.onmousedown);\n        this.view.off(\"pressmove\", this._basicsListeners.onmousemove);\n        // this.view.removeAllEventListeners()\n    }\n    set anchorX(value) {\n        this._anchorX = value;\n        this.view.regX = this._anchorX;\n    }\n    get anchorX() {\n        return this._anchorX;\n    }\n    set anchorY(value) {\n        this._anchorY = value;\n        this.view.regY = this.anchorY;\n    }\n    get anchorY() {\n        return this._anchorY;\n    }\n    set anchor(value) {\n        this.anchorY = value;\n        this.anchorX = value;\n    }\n    get anchor() {\n        return { anchorX: this.anchorX, anchorY: this.anchorY };\n    }\n    makeRotationOffset() {\n        return Math.cos((this.rotation % 90) * (Math.PI / 180));\n    }\n    cache({ scale = 1, quality = this.jx.config.flashOptimizer.quality } = {}) {\n        if (scale === \"fixe\") {\n            let resScreen = this.jx.config.system.screen.resolutionUser;\n            let visualBounds = this.view.getBounds();\n            let stage = this.jx.app.stage || resScreen;\n            let scaleW = this.width * resScreen.width / (visualBounds.width * stage.width);\n            let scaleH = this.height * resScreen.height / (visualBounds.height * stage.height);\n            scale = Math.min(scaleW, scaleH);\n            console.log(stage, scale);\n        }\n        scale = Math.abs(scale);\n        let scaleFactor = this.jx.config.urlParams.scaleFactor != undefined ? this.jx.config.urlParams.scaleFactor : 1;\n        var bounds = this.view.getBounds() || this.view.nominalBounds || { x: 0, y: 0, width: 1, height: 1 };\n        let qualityFactor = quality == \"best\" ? window.devicePixelRatio : 1;\n        let ratio = Math.max(this.jx.config.system.screen.resolution.width, this.jx.config.system.screen.resolution.height) / Math.max(bounds.width * this.view.scaleX, bounds.height * this.view.scaleY);\n        ratio = ratio < 1 ? ratio : 1;\n        if (this.id == 1) { }\n        ;\n        let scaleTotal = Math.max(this.view.scaleX, this.view.scaleY) * ratio * scaleFactor * qualityFactor * scale;\n        if (bounds.width * scaleTotal > 2048 || bounds.height * scaleTotal > 2048) {\n            console.warn(\"Image Cache reaches max limits 2048 and has been reduced to fit in limits\", this.id, this.view);\n            scaleTotal = Math.min(2048 / bounds.width, 2048 / bounds.height);\n        }\n        ;\n        this.view.cache(bounds.x, bounds.y, bounds.width, bounds.height, scaleTotal);\n        if (this.view.cacheCanvas.width > 2048 || this.view.cacheCanvas.height > 2048) {\n            console.error(\"Image Cache reaches max limits 2048 (reduction auto has not working)\", this.view.cacheCanvas, this.view);\n        }\n        else {\n            // console.info(\"Image Cache\", this.view.cacheCanvas.width, this.view.cacheCanvas, this.jx.config.system.screen.resolution, this.view)\n        }\n    }\n    updateCache() {\n        this.view.updateCache();\n    }\n    uncache() {\n        this.view.uncache();\n    }\n    localToGlobal(...args) {\n        return this.view.localToGlobal(...args);\n    }\n    globalToLocal(...args) {\n        return this.view.globalToLocal(...args);\n    }\n    localToLocal(...args) {\n        return this.view.localToLocal(...args);\n    }\n    bringToFront() {\n        if (this.view.parent)\n            this.view.parent.setChildIndex(this.view, this.view.parent.numChildren - 1);\n    }\n    bringToBack() {\n        if (this.view.parent)\n            this.view.parent.setChildIndex(this.view, 0);\n    }\n    set cursor(value) {\n        this._cursorOnRoll = value;\n        if (this._enabled) {\n            this.view.cursor = value;\n        }\n        else {\n            this.view.cursor = this._cursorOnDisabled;\n        }\n    }\n    get cursor() {\n        return this._cursorOnRoll;\n    }\n    get parent() {\n        if (this.view.parent && this.view.parent._jxClip) {\n            return this.view.parent._jxClip;\n        }\n        else {\n            return null;\n        }\n    }\n    set parent(value) {\n        this._parent = value;\n    }\n}\n"]}