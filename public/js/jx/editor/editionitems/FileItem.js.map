{"version":3,"sources":["../../../../src/jx/editor/editionitems/FileItem.js"],"names":["_templates","asset","source","download","openDir","deleteFile","push","pull","_template","icoTitle","icoSymbol","actions","informations","backgroundColor","activable","actionsArr","i","length","join","informationsArr","activatedCheckBox","FileItem","dataObject","data","editable","undefined","Object","assign","index","onfiledropped","addEventDispatcher","add","type","toLowerCase","jx","tools","arr","removeDouble","concat","view","$","autoRefresh","prop","id","css","find","value","title","text","description","src","html","console","warn","config","system","host","click","event","controller","openParentDirectory","pushFile","pullFile","deleteItemLinkedFile","downloadItem","indexOf","showItem","removeClass","toggleInfo","change","log","mainController","project","getInGabarit","gabaritPath","activated","onchanged","dispatch","target","item","dropZone","addDropZone","callback","evt","_controller","destAssetsDir","info","url","assetsDir","itemInfo","replace","lang","zoneDropDOM","zoneDroppedDOM","acceptedFiles","Sound","Image","ImageSequence","PDF","PSD","FLA","Flashtml","FontPack","Video","me","numFiles","finishDrop","Dropzone","maxFiles","parallelUploads","clickable","addRemoveLinks","previewsContainer","dictMaxFilesExceeded","autoProcessQueue","on","file","fileType","name","split","toUpperCase","extensionDropped","pop","acceptedFilesArr","isValideFileType","alert","removeFile","destFileArr","destFileFullnameNonReplaced","destFileFullname","destFilename","destFileExtension","destDir","filename","extension","search","RegExp","xhr","formData","start","end","gabaritObj","save","append","fileNameWithoutExt","shift","extensionDest","srcDestArr","gabaritID","resources","resource","filter","itemRes","splice","json","dropResult","check","editor","unzip","path","filePath","message","deleteZipFile","parentDirName","parentDirPath","parent","itemParent","enable","disable"],"mappings":"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","file":"FileItem.js","sourcesContent":["import BasicItem from \"jx/editor/editionitems/BasicItem\";\nlet _templates = {\n    asset: '<div  id=\"assetValue\"></div>',\n    source: '<div  id=\"sourceValue\"></div>',\n    download: ' <button class=\"btn btn-default\" tabindex=\"-1\" title=\"Télécharger le fichier\" id=\"download\"><span class=\"fa fa-download\"></span></button>',\n    openDir: ' <button class=\"btn btn-default\" tabindex=\"-1\" title=\"Ouvrir le dossier parent\" id=\"openDir\"><span class=\"fa fa-folder-open-o\"></span></button>',\n    deleteFile: ' <button class=\"btn btn-default\" tabindex=\"-1\" title=\"Supprimer le fichier associé\" id=\"deleteFile\"><span class=\"fa fa-trash-o\"></span></button>',\n    push: ' <button class=\"btn btn-default\" tabindex=\"-1\" title=\"Ouvrir le dossier parent\" id=\"push\">PUSH</button>',\n    pull: ' <button class=\"btn btn-default\" tabindex=\"-1\" title=\"Ouvrir le dossier parent\" id=\"pull\">PULL</button>'\n};\nlet _template = function ({ icoTitle, icoSymbol = \"gear\", actions = \"\", informations = \"\", backgroundColor = \"#FFFFFF\", activable = false }) {\n    // console.log(\"actions\", actions)\n    var actionsArr = [];\n    for (var i = 0; i < actions.length; i++) {\n        actionsArr.push(_templates[actions[i]]);\n    }\n    ;\n    actions = actionsArr.join(\"\");\n    var informationsArr = [];\n    for (var i = 0; i < informations.length; i++) {\n        informationsArr.push(_templates[informations[i]]);\n    }\n    ;\n    informations = informationsArr.join(\"\");\n    let activatedCheckBox = !activable ? \"\" : '<input type=\"checkbox\" name=\"enabled\"  id=\"enabled\" checked style=\"display:inline;position:relative;top:-38px;left:-10px\">';\n    return `\n    <div class=\"form-group row\">\n        <div class=\"row\">\n            <div class=\"col-xs-5\">\n\n                <div class=\"input-group\" style=\"width:100%\">\n                    <span title=\"${icoTitle}\" id=\"ico\" class=\"input-group-addon btn btn-default\" style=\"width:40px; background-color: ${backgroundColor};\"><span class=\"fa fa-${icoSymbol}\"></span>                   \n                    </span>\n                    <input type=\"text\" tabindex=\"-1\" class=\"form-control\"  style=\"background-color: ${backgroundColor};\" id=\"id\" value=\"\" readonly=\"true\" >\n\n                </div>\n                ${activatedCheckBox}\n\n            </div>\n             <div class=\"col-xs-7\">\n                <button class=\"btn btn-default\" tabindex=\"-1\" title=\"Informations\" id=\"info\"><span class=\"fa fa-info\"></span></button>\n                ${actions}\n            </div>\n        </div>\n        <div  id=\"informationsPanel\" class=\"row\"  style=\"display:none;\">\n            <div class=\"col-xs-12\" id=\"informationsText\">\n                <div id=\"description\"  style=\"display:block\"></div>\n                <div id=\"processus\" style=\"display:block\"></div>\n                ${informations}\n            </div>\n        </div>\n        <div   class=\"row\" >\n            <div class=\"col-xs-12\" id=\"zoneDrop\">\n                <div id=\"DropZone\" class=\"dropzone\"></div>\n            </div>\n        </div>\n    </div>\n    `;\n};\nexport default class FileItem extends BasicItem {\n    constructor(dataObject) {\n        if (dataObject.data.editable == undefined) {\n            dataObject.data.editable = true;\n        }\n        ; // override default BasicItem value\n        super(Object.assign({\n            icoTitle: \"Voir\",\n            icoSymbol: \"file-powerpoint-o\",\n            actions: [],\n            informations: [\"asset\", \"source\"],\n            backgroundColor: \"#CC6666\",\n            index: 0,\n            onfiledropped: null\n        }, dataObject));\n        this.addEventDispatcher([\"onfiledropped\"]);\n        if (this.dataObject.onfiledropped)\n            this.onfiledropped.add(this.dataObject.onfiledropped);\n        this.dataObject.activable = this.dataObject.data.activable;\n        //-- by default, \n        // - type FileItem (and not subclass of FileItem), preview and download actions are availables.\n        // - all have openDir action available\n        if (this.dataObject.data.type.toLowerCase() == \"fileitem\") {\n            this.dataObject.actions = this.jx.tools.arr.removeDouble((this.dataObject.actions || []).concat([\"openDir\", \"preview\", \"download\"]));\n        }\n        else {\n            this.dataObject.actions = this.jx.tools.arr.removeDouble((this.dataObject.actions || []).concat([\"openDir\"]));\n        }\n        // this.dataObject.actions = this.jx.tools.arr.removeDouble((this.dataObject.actions || []).concat([\"openDir\", \"push\", \"pull\"]));\n        this.view = $(_template(this.dataObject));\n        this.autoRefresh = true;\n        this.view.prop('id', this.data.id);\n        this.view.css('margin-bottom', \"5px\");\n        this.view.find(\"#id\")[0].value = this.data.title || this.data.id;\n        this.view.find(\"#description\").text(this.data.description);\n        //-- asset\n        if (this.data.asset.src != null) {\n            this.view.find(\"#assetValue\").html(`<b>Asset: </b>${this.data.asset.src}`);\n        }\n        else {\n            console.warn(\"path of asset \", this.data.id, \" not defined\");\n            this.view.find(\"#assetValue\").html(`<b>Asset: </b>NOT DEFINED`);\n        }\n        if (this.jx.config.system.host.type != \"local\") {\n            this.view.find(\"#openDir\").css(\"display\", \"none\");\n            this.view.find(\"#push\").css(\"display\", \"none\");\n            this.view.find(\"#pull\").css(\"display\", \"none\");\n        }\n        this.view.find(\"#openDir\").click((event) => this.controller.openParentDirectory(this.data));\n        this.view.find(\"#push\").click((event) => this.controller.pushFile(this.data));\n        this.view.find(\"#pull\").click((event) => this.controller.pullFile(this.data));\n        this.view.find(\"#deleteFile\").click(() => this.deleteItemLinkedFile());\n        //-- allow download only if source not defined\n        this.view.find(\"#download\").click((event) => this.controller.downloadItem(this.data));\n        this.view.find(\"#processus\").html(\"<b>Procédure:</b> téléchargez ce fichier(<span class='fa fa-download'>), modifiez le, et glissez le sur l'identifiant pour le mettre à jour. \");\n        if (this.dataObject.actions.indexOf(\"preview\") != -1) {\n            this.view.find(\"#ico\").click((event) => {\n                this.controller.showItem(this.data);\n            });\n        }\n        else {\n            this.view.find(\"#ico\").removeClass('btn btn-default');\n        }\n        this.view.find(\"#info\").click((event) => this.toggleInfo());\n        this.view.find(\"#enabled\").change((event) => {\n            console.log(\"ONCHANGE\", event, this.view.find(\"#enabled\").prop(\"checked\"));\n            var data = this.controller.mainController.project.getInGabarit({ id: this.gabaritPath });\n            data.activated = this.view.find(\"#enabled\").prop(\"checked\");\n            this.onchanged.dispatch({ target: this });\n        });\n        this.item = this.view;\n        //-- add drop fonctionnality\n        // this.dropZone = this.controller.addItemDropzone(Object.assign({item: this}, this.data));\n        this.dropZone = this.addDropZone();\n    }\n    deleteItemLinkedFile(callback = evt => { }) {\n        this.controller.deleteItemLinkedFile(this.data, evt => {\n            console.log(\"fileitem\", evt);\n            callback(evt);\n        });\n    }\n    /** add drop functionnality on item */\n    addDropZone() {\n        // console.log(\"dd \", this)\n        let item = this;\n        let _controller = this.controller.mainController; //Edition\n        // let destAssetsDir = _controller.project.info.url + \"/public/assets/\";\n        let destAssetsDir = _controller.project.info.url + \"/\" + _controller.project.info.assetsDir + \"/\";\n        var itemInfo = {\n            id: item.data.id,\n            type: item.data.asset.type,\n            src: item.data.asset.src.replace(\"${lang}\", this.lang),\n            zoneDropDOM: item.view.find(\"#id\")[0],\n            zoneDroppedDOM: item.view.find(\"#DropZone\")[0],\n        };\n        // let dropzone_template = `\n        // <div class=\"dz-preview dz-file-preview\">\n        //     <div class=\"dz-details\">\n        //         <div class=\"dz-filename\"><span data-dz-name></span></div>\n        //         <div class=\"dz-size\" data-dz-size></div>\n        //         <div class=\"dz-image\"><img data-dz-thumbnail></div>\n        //     </div>\n        //     <div class=\"dz-progress\"><span class=\"dz-upload\" data-dz-uploadprogress></span></div>\n        //     <div class=\"dz-success-mark\"><span>✔</span></div>\n        //     <div class=\"dz-error-mark\"><span>✘</span></div>\n        //     <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n        // </div>`;\n        var acceptedFiles = {\n            Sound: \"audio/mp3,audio/mpeg\",\n            Image: \"image/png,image/jpg,image/jpeg\",\n            ImageSequence: \"image/png,image/jpg,image/jpeg\",\n            PDF: \"application/pdf\",\n            PSD: \"application/psd,image/vnd.adobe.photoshop\",\n            FLA: \"application/fla\",\n            Flashtml: \"application/zip\",\n            FontPack: \"application/octet-stream\",\n            Video: \"video/mp4\" // /ogg /webm\n        };\n        let me = this;\n        var numFiles = 0;\n        var finishDrop = true;\n        var dropZone = new Dropzone(itemInfo.zoneDropDOM, {\n            url: \"/fileupload\",\n            //previewTemplate: $(dropzone_template).html(),\n            //acceptedFiles: acceptedFiles[itemData.asset.type],\n            maxFiles: 500,\n            parallelUploads: 200,\n            //dictInvalidFileType: \"Fichier non valide\\nLe format du fichier doit être de type '\"+itemData.asset.type+\"'\",\n            clickable: true,\n            addRemoveLinks: true,\n            previewsContainer: itemInfo.zoneDroppedDOM,\n            dictMaxFilesExceeded: \"\",\n            autoProcessQueue: true\n        });\n        //--- DROP\n        dropZone.on('drop', (event) => {\n            console.log(\"dd DROP\", event);\n            numFiles = 0;\n            finishDrop = false;\n        });\n        //--- ADD FILE\n        dropZone.on('addedfile', (file) => {\n            // console.log('dd addedfile', file, file.type);\n            //-- Get type of dropped file\n            var fileType = file.type;\n            // the type must be corrected for some cases:\n            // case: FLA file detection\n            if (itemInfo.type == \"FLA\" && file.name.split(\".\")[1].toUpperCase() == \"FLA\") {\n                fileType = \"application/fla\";\n            }\n            // case: Flashtml zip package\n            if (itemInfo.type == \"Flashtml\" && file.name.split(\".\")[1].toUpperCase() == \"ZIP\") {\n                fileType = \"application/zip\";\n            }\n            // case: Flashtml zip package\n            if (itemInfo.type == \"FontPack\") {\n                var extensionDropped = file.name.split(\".\").pop().toLowerCase();\n                if (extensionDropped == \"ttf\" || extensionDropped == \"otf\") {\n                    fileType = \"application/octet-stream\";\n                }\n                else {\n                    fileType = extensionDropped;\n                }\n            }\n            //-- Detect if type file is allowed by item.\n            var acceptedFilesArr = acceptedFiles[itemInfo.type] || \"\";\n            acceptedFilesArr = acceptedFilesArr.split(\",\");\n            var isValideFileType = (fileType) => {\n                for (var i = 0; i < acceptedFilesArr.length; i++) {\n                    if (acceptedFilesArr[i] == fileType) {\n                        return true;\n                    }\n                    ;\n                }\n                ;\n                return false;\n            };\n            if (!isValideFileType(fileType)) {\n                // if type is not valid, we alert user and remove file from drop files list.\n                alert(\"Fichier non valide\\nLe format du fichier doit être de type\\n '\" + acceptedFiles[itemInfo.type] + \"'\\nau lieu de\\n\" + fileType);\n                dropZone.removeFile(file);\n            }\n            else {\n                //-- specific for imageSequence\n                if (itemInfo.type == \"ImageSequence\") {\n                    // itemData.asset.src = \"tigre/sequence1/titigre_som_P0###.png\";\n                    var destFileArr = itemInfo.src.split(\"/\");\n                    var destFileFullnameNonReplaced = destFileArr[destFileArr.length - 1];\n                    var destFileFullname = destFileFullnameNonReplaced.replace(/#/g, \"[0-9]\");\n                    var destFilename = destFileFullname.split(\".\")[0];\n                    var destFileExtension = destFileFullname.split(\".\")[1];\n                    destFileArr.pop();\n                    var destDir = destAssetsDir + destFileArr.join(\"/\");\n                    var filename = file.name.split(\".\")[0];\n                    var extension = file.name.split(\".\")[1];\n                    if (filename.search(new RegExp(destFilename)) != -1 && destFileExtension.toUpperCase() == extension.toUpperCase()) {\n                        numFiles++;\n                        //formData.append(\"destPath\", destDir+\"/\"+ filename + \".\"+ destFileExtension);\n                    }\n                    else {\n                        numFiles++;\n                        dropZone.removeFile(file);\n                        alert(\"Le nom du fichier ne correspond pas au modèle nécessaire:\\n\" + file.name + \"\\nau lieu de\\n\" + destFileFullnameNonReplaced);\n                    }\n                }\n                //this.processQueue();\n                //this.addFile(file);\n            }\n        });\n        //-- SENDING\n        dropZone.on(\"sending\", (file, xhr, formData) => {\n            // console.log(\"dd sending\", file);\n            //-- specific for ImageSequence\n            if (!finishDrop && itemInfo.type == \"ImageSequence\") {\n                item.data.asset.start = 1;\n                item.data.asset.end = numFiles;\n                var gabaritObj = _controller.getInGabarit({ id: itemInfo.id });\n                gabaritObj.asset.start = 1;\n                gabaritObj.asset.end = numFiles;\n                _controller.save();\n                // TODO: for delete directory dest before, server side not finished.\n                var destFileArr = itemInfo.src.split(\"/\");\n                destFileArr.pop();\n                var destDir = destAssetsDir + destFileArr.join(\"/\");\n                formData.append(\"delPath\", destDir);\n            }\n            finishDrop = true;\n            // Will send the filesize along with the file as POST data.\n            //-- specific for ImageSequence\n            if (itemInfo.type == \"ImageSequence\") {\n                var destFileArr = itemInfo.src.split(\"/\");\n                var destFileFullname = destFileArr[destFileArr.length - 1].replace(/#/g, \"[0-9]\");\n                var destFilename = destFileFullname.split(\".\")[0];\n                var destFileExtension = destFileFullname.split(\".\")[1];\n                destFileArr.pop();\n                var destDir = destAssetsDir + destFileArr.join(\"/\");\n                var filename = file.name.split(\".\")[0];\n                var extension = file.name.split(\".\")[1];\n                if (filename.search(new RegExp(destFilename)) != -1 && destFileExtension.toUpperCase() == extension.toUpperCase()) {\n                    formData.append(\"destPath\", destDir + \"/\" + filename + \".\" + destFileExtension);\n                }\n            }\n            //-- specific for Flashtml\n            else if (itemInfo.type == \"Flashtml\") {\n                //console.log(\"Sending Flashtml\", itemData.asset.src, itemData)\n                formData.append(\"destPath\", destAssetsDir + itemInfo.src + \".zip\");\n            }\n            else if (itemInfo.type == \"FontPack\") {\n                //console.log(\"Sending Flashtml\", itemData.asset.src, itemData)\n                let fileNameWithoutExt = file.name.split(\".\").shift();\n                var extensionDropped = file.name.split(\".\").pop().toLowerCase();\n                console.log(extensionDropped);\n                formData.append(\"destPath\", destAssetsDir + fileNameWithoutExt + \"/\" + file.name);\n            }\n            //-- for all others\n            else {\n                //- detect if format has changed (ex: png drop on item with jpg src), \n                // to adapt the item src with new file's extension\n                var extensionDropped = file.name.split(\".\")[1];\n                var extensionDest = itemInfo.src.split(\".\")[1];\n                if (extensionDropped != extensionDest) {\n                    // change the extension\n                    var srcDestArr = item.data.asset.src.split(\".\");\n                    srcDestArr.pop();\n                    srcDestArr.push(extensionDropped);\n                    item.data.asset.src = srcDestArr.join(\".\");\n                    itemInfo.src = item.data.asset.src.replace(\"${lang}\", _controller.lang); // for multi lang support\n                    //-- Need here to get the data in gabarit json, because FileItem data is not linked to gabarit data like others items.\n                    console.log(item.data.gabaritID);\n                    if (item.data.gabaritID) {\n                        let arr = item.gabaritPath.split(\".\");\n                        arr.pop();\n                        arr.push(item.data.gabaritID);\n                        var data = _controller.project.getInGabarit({ id: arr.join(\".\") });\n                        data.asset.resources = data.asset.resources || [];\n                        let resource = data.asset.resources.filter(itemRes => itemRes.id == item.data.id)[0];\n                        data.asset.src = item.data.asset.src;\n                        if (resource) {\n                            data.asset.resources.splice(data.asset.resources.indexOf(resource), 1);\n                        }\n                        if (extensionDropped != data.asset.src.split(\".\").pop()) {\n                            data.asset.resources.push({ id: item.data.id, src: item.data.asset.src });\n                        }\n                    }\n                    else {\n                        var data = _controller.project.getInGabarit({ id: item.gabaritPath });\n                        data.asset.src = item.data.asset.src;\n                    }\n                    item.onchanged.dispatch({ target: item });\n                    // _controller.save();\n                }\n                console.log(\"destDiro\", destAssetsDir + itemInfo.src);\n                if (itemInfo.type == \"FontPack\") {\n                    let fileNameWithoutExt = file.name.split(\".\").shift();\n                    var extensionDropped = file.name.split(\".\").pop().toLowerCase();\n                    console.log(extensionDropped);\n                    if (extensionDropped == \"ttf\") {\n                        formData.append(\"destPath\", destAssetsDir + itemInfo.src.replace(/zip$/, \"ttf\"));\n                    }\n                    else {\n                        formData.append(\"destPath\", destAssetsDir + itemInfo.src);\n                    }\n                }\n                else {\n                    formData.append(\"destPath\", destAssetsDir + itemInfo.src);\n                }\n            }\n        });\n        //-- SUCCESS\n        dropZone.on('success', (file, json) => {\n            console.log('dd success', file);\n            let dropResult = {};\n            let fileNameWithoutExt = file.name.split(\".\").shift();\n            let extensionDropped = file.name.split(\".\").pop().toLowerCase();\n            if (item.check)\n                item.check();\n            if (itemInfo.type == \"Flashtml\") {\n                this.jx.editor.unzip({ path: destAssetsDir + itemInfo.src + \".zip\" });\n                dropResult.filePath = null;\n                dropResult.message = \"the file of type Flashtml has been unzipped and don't exists anymore\";\n            }\n            else if (itemInfo.type == \"FontPack\") {\n                if (extensionDropped == \"zip\") {\n                    dropResult.filePath = destAssetsDir + itemInfo.src + \".zip\";\n                    this.jx.editor.unzip({ path: destAssetsDir + itemInfo.src + \".zip\", deleteZipFile: item.data.deleteZipFile === false ? false : undefined });\n                }\n                else {\n                    dropResult.filePath = destAssetsDir + fileNameWithoutExt + \"/\" + file.name;\n                    dropResult.parentDirName = fileNameWithoutExt;\n                    dropResult.parentDirPath = destAssetsDir + fileNameWithoutExt;\n                }\n            }\n            dropZone.removeFile(file);\n            this.onfiledropped.dispatch(dropResult);\n        });\n        //-- MAX FILE EXCEEDED - if dropped files num exceeds the max allowed, we alert user.\n        dropZone.on('maxfilesexceeded', (file) => {\n            alert(\"Nombre de fichiers supérieur au nombre requis: 1\");\n        });\n        //console.log(dropZone)\n        return dropZone;\n    }\n    get gabaritPath() {\n        var path = this.data.id;\n        var parent = this.itemParent;\n        while (parent) {\n            path = parent.data.id + \".\" + path;\n            parent = parent.itemParent;\n        }\n        return path;\n    }\n    check() {\n        this.view.find(\"#ico\").css(\"background-color\", \"#00ff00\");\n        this.onchanged.dispatch({ target: this });\n    }\n    set lock(value) {\n        if (!value) {\n            if (this.editable) {\n                this.dropZone.enable();\n            }\n            else {\n                this.dropZone.disable();\n            }\n        }\n        else {\n            this.dropZone.disable();\n        }\n    }\n}\n"]}