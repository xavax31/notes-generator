{"version":3,"sources":["../../../../src/jx/editor/editionitems/ButtonItem.js"],"names":["textInput","ButtonItem","dataObject","controller","commonLib","jx","item","$","prop","data","id","confirmBeforeLaunch","undefined","description","editable","editor","getBoolDependsGroup","css","find","text","attr","title","click","event","clickFunc","comm","onclick","replace","search","mainController","html","execBash","output","scriptName","args","arg1","evt","stdout","popup","content","buttons","ok","label","close","onclose","action","console","log","target","panelInfo","view","visible","value"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,QAAIA,slCAAJ;;QA6BqBC,U;;;AACjB,4BAAYC,UAAZ,EAAwB;AAAA;;AAAA,gIACdA,UADc;;AAEpB,kBAAKC,UAAL,GAAkB,MAAKD,UAAL,CAAgBC,UAAlC;AACA,kBAAKC,SAAL,GAAiB,qBAAW,EAAEC,IAAI,MAAKA,EAAX,EAAX,CAAjB;AACA,gBAAIC,OAAOC,EAAEP,SAAF,CAAX;AACAM,iBAAKE,IAAL,CAAU,IAAV,EAAgB,MAAKC,IAAL,CAAUC,EAA1B;AACA,kBAAKC,mBAAL,GAA2B,MAAKF,IAAL,CAAUE,mBAAV,IAAiCC,SAAjC,GAA6C,IAA7C,GAAoD,MAAKH,IAAL,CAAUE,mBAAzF;AACA,kBAAKF,IAAL,CAAUI,WAAV,GAAwB,MAAKJ,IAAL,CAAUI,WAAV,IAAyB,EAAjD;AACA,kBAAKC,QAAL,GAAgB,MAAKT,EAAL,CAAQU,MAAR,CAAeC,mBAAf,CAAmC,MAAKP,IAAL,CAAUK,QAA7C,EAAuD,IAAvD,CAAhB;AACAR,iBAAKW,GAAL,CAAS,QAAT,EAAmB,KAAnB;;AAEAX,iBAAKY,IAAL,CAAU,cAAV,EAA0BC,IAA1B,CAA+B,MAAKV,IAAL,CAAUI,WAAzC;AACAP,iBAAKY,IAAL,CAAU,QAAV,EAAoBV,IAApB,CAAyB,UAAzB,EAAqC,IAArC;AACAF,iBAAKY,IAAL,CAAU,QAAV,EAAoBD,GAApB,CAAwB,SAAxB,EAAmC,MAAnC;;AAEAX,iBAAKY,IAAL,CAAU,MAAV,EAAkBE,IAAlB,CAAuB,OAAvB,EAAiC,MAAKX,IAAL,CAAUY,KAAV,IAAmB,MAAKZ,IAAL,CAAUC,EAA9D;AACAJ,iBAAKY,IAAL,CAAU,MAAV,EAAkBI,KAAlB,CAAwB,UAACC,KAAD,EAAW;AAC/B,oBAAIC,YAAY,SAAZA,SAAY,GAAM;AAClBlB,yBAAKY,IAAL,CAAU,MAAV,EAAkBV,IAAlB,CAAuB,UAAvB,EAAmC,IAAnC;AACA,wBAAIiB,aAAJ;AACA,wBAAI,OAAO,MAAKhB,IAAL,CAAUiB,OAAjB,IAA4B,UAAhC,EAA4C;AACxCD,+BAAO,MAAKhB,IAAL,CAAUiB,OAAjB;AACAD;AACAnB,6BAAKY,IAAL,CAAU,MAAV,EAAkBV,IAAlB,CAAuB,UAAvB,EAAmC,KAAnC;AACH,qBAJD,MAKK;AACDiB,+BAAO,MAAKhB,IAAL,CAAUiB,OAAV,CAAkBC,OAAlB,CAA0B,KAA1B,EAAiC,EAAjC,CAAP;AACA,4BAAIF,KAAKG,MAAL,CAAY,WAAZ,KAA4B,CAAC,CAAjC,EAAoC;AAChCH,mCAAOA,KAAKE,OAAL,CAAa,WAAb,EAA0B,EAA1B,CAAP;AACA,kCAAKxB,UAAL,CAAgB0B,cAAhB,CAA+BJ,IAA/B;AACAnB,iCAAKY,IAAL,CAAU,MAAV,EAAkBV,IAAlB,CAAuB,UAAvB,EAAmC,KAAnC;AACH,yBAJD,MAKK,IAAI,MAAKH,EAAL,CAAQU,MAAR,CAAeU,IAAf,CAAJ,EAA0B;AAC3B,kCAAKpB,EAAL,CAAQU,MAAR,CAAeU,IAAf;AACAnB,iCAAKY,IAAL,CAAU,MAAV,EAAkBV,IAAlB,CAAuB,UAAvB,EAAmC,KAAnC;AACH,yBAHI,MAIA;AACDF,iCAAKY,IAAL,CAAU,QAAV,EAAoBY,IAApB,CAAyB,iBAAzB;AACAxB,iCAAKY,IAAL,CAAU,QAAV,EAAoBD,GAApB,CAAwB,SAAxB,EAAmC,QAAnC;AACA,kCAAKZ,EAAL,CAAQU,MAAR,CAAegB,QAAf,CAAwB,EAAEC,QAAQ,KAAV,EAAiBC,YAAYR,IAA7B,EAAmCS,MAAM,EAAEC,MAAM,MAAR,EAAzC,EAAxB,EAAqF,eAAO;AAExF7B,qCAAKY,IAAL,CAAU,QAAV,EAAoBY,IAApB,CAAyBM,IAAIC,MAA7B;AACA/B,qCAAKY,IAAL,CAAU,MAAV,EAAkBV,IAAlB,CAAuB,UAAvB,EAAmC,KAAnC;AACH,6BAJD;AAKH;AACJ;AACJ,iBA7BD;AA8BA,oBAAI,MAAKG,mBAAT,EAA8B;AAC1B,0BAAKN,EAAL,CAAQU,MAAR,CAAeuB,KAAf,CAAqB;AACjBjB,+BAAO,eADU;AAEjBkB,iCAAS,uDAAuD,MAAK9B,IAAL,CAAUY,KAAV,IAAmB,MAAKZ,IAAL,CAAUC,EAApF,IAA0F,MAA1F,GAAmG,MAAKD,IAAL,CAAUI,WAFrG;AAGjB2B,iCAAS;AACLC,gCAAI,EAAEC,OAAO,QAAT,EADC;AAELC,mCAAO,EAAED,OAAO,QAAT;AAFF,yBAHQ;AAOjBE,iCAAS,sBAAO;AACZ,gCAAIR,IAAIS,MAAJ,IAAc,IAAlB,EAAwB;AACpBrB;AACH;AACJ;AAXgB,qBAArB;AAaH,iBAdD,MAeK;AACDA;AACH;AACJ,aAjDD;;AAmDAlB,iBAAKY,IAAL,CAAU,OAAV,EAAmBI,KAAnB,CAAyB,UAACC,KAAD,EAAW;AAChCuB,wBAAQC,GAAR,CAAY,MAAZ,EAAoBxB,MAAMyB,MAA1B,EAAkC1C,KAAK,CAAL,EAAQI,EAA1C;AACA,oBAAIuC,YAAY3C,KAAKY,IAAL,CAAU,oBAAV,CAAhB;AACA+B,0BAAUhC,GAAV,CAAc,SAAd,EAA0BgC,UAAUhC,GAAV,CAAc,SAAd,KAA4B,MAA5B,GAAqC,QAArC,GAAgD,MAA1E;AACH,aAJD;AAKAX,iBAAKG,IAAL,CAAU,YAAV;AACA,kBAAKH,IAAL,GAAYA,IAAZ;AACA,kBAAK4C,IAAL,GAAY,MAAK5C,IAAjB;AACA,gBAAI6C,UAAU,MAAK9C,EAAL,CAAQU,MAAR,CAAeC,mBAAf,CAAmC,MAAKP,IAAL,CAAU0C,OAA7C,EAAsD,IAAtD,CAAd;AACA,kBAAKD,IAAL,CAAUjC,GAAV,CAAc,SAAd,EAA0BkC,UAAU,OAAV,GAAoB,MAA9C;AA5EoB;AA6EvB;;;;uCAMU;AACP,qBAAKD,IAAL,CAAUhC,IAAV,CAAe,oBAAf,EAAqCD,GAArC,CAAyC,SAAzC,EAAoD,QAApD;AACH;;;uCAEU;AACP,qBAAKiC,IAAL,CAAUhC,IAAV,CAAe,oBAAf,EAAqCD,GAArC,CAAyC,SAAzC,EAAoD,MAApD;AACH;;;gCAXW;AAER,uBAAO,KAAKX,IAAL,CAAUY,IAAV,CAAe,QAAf,EAAyB,CAAzB,EAA4BkC,KAAnC;AACH;;;8BASQA,K,EAAO;AACZ,oBAAI,CAACA,KAAL,EAAY;AACR,yBAAKF,IAAL,CAAUhC,IAAV,CAAe,MAAf,EAAuBV,IAAvB,CAA4B,UAA5B,EAAwC,CAAC,KAAKM,QAA9C;AACH,iBAFD,MAGK;AACD,yBAAKoC,IAAL,CAAUhC,IAAV,CAAe,MAAf,EAAuBV,IAAvB,CAA4B,UAA5B,EAAwC,IAAxC;AACH;AACJ;;;;;;sBAlGgBP,U","file":"ButtonItem.js","sourcesContent":["import VisualComponent from \"jx/core/comps/VisualComponent\";\nimport Common from \"jx/editor/editionitems/Common\";\nlet textInput = `\n<div class=\"form-group row\">\n    <div class=\"row\">\n        <div class=\"col-xs-5\">\n            <div class=\"input-group\">\n                <span id=\"check\" class=\"input-group-addon\"><span class=\"fa fa-tasks\"></span></span>\n                <input type=\"text\" class=\"btn btn-default form-control\" id=\"btn\" value=\"\">\n            </div>\n        </div>\n        <div class=\"col-xs-1\">\n             <button class=\"btn btn-default\" title=\"Informations\" id=\"info\"><span class=\"fa fa-info\"></span></button>\n        </div>\n        <div class=\"col-xs-6\">\n        </div>\n    </div>\n\n    <div class=\"row\">\n        <div class=\"col-xs-12\">\n            <textarea id=\"value\" type=\"textarea\" style=\"resize:vertical\"  spellcheck=\"true\"  rows=\"1\" class=\"form-control\"></textarea>\n        </div>\n    </div>\n    \n    <div  id=\"informationsPanel\" class=\"row\"  style=\"display:none;\">\n        <div class=\"col-xs-12\" id=\"informationsText\">\n            <div class\"xinputtext\" id=\"description\" ></div>\n        </div>\n    </div>\n</div>\n`;\nexport default class ButtonItem extends VisualComponent {\n    constructor(dataObject) {\n        super(dataObject);\n        this.controller = this.dataObject.controller;\n        this.commonLib = new Common({ jx: this.jx });\n        var item = $(textInput);\n        item.prop('id', this.data.id);\n        this.confirmBeforeLaunch = this.data.confirmBeforeLaunch == undefined ? true : this.data.confirmBeforeLaunch;\n        this.data.description = this.data.description || \"\";\n        this.editable = this.jx.editor.getBoolDependsGroup(this.data.editable, true);\n        item.css(\"margin\", \"0px\");\n        //if (this.data.description == undefined) { item.remove($(item.description_btn)); }\n        item.find(\"#description\").text(this.data.description);\n        item.find(\"#value\").prop('readonly', true);\n        item.find(\"#value\").css(\"display\", \"none\");\n        //item.find(\"#btn\").css(\"width\", \"100%\");\n        item.find(\"#btn\").attr(\"value\", (this.data.title || this.data.id));\n        item.find(\"#btn\").click((event) => {\n            let clickFunc = () => {\n                item.find(\"#btn\").prop(\"disabled\", true);\n                let comm;\n                if (typeof this.data.onclick == \"function\") {\n                    comm = this.data.onclick;\n                    comm();\n                    item.find(\"#btn\").prop(\"disabled\", false);\n                }\n                else { // string\n                    comm = this.data.onclick.replace(/^\\$/, \"\");\n                    if (comm.search(/^project./) != -1) {\n                        comm = comm.replace(/^project./, \"\");\n                        this.controller.mainController[comm]();\n                        item.find(\"#btn\").prop(\"disabled\", false);\n                    }\n                    else if (this.jx.editor[comm]) {\n                        this.jx.editor[comm]();\n                        item.find(\"#btn\").prop(\"disabled\", false);\n                    }\n                    else {\n                        item.find(\"#value\").html(\"Wait please ...\");\n                        item.find(\"#value\").css(\"display\", \"inline\");\n                        this.jx.editor.execBash({ output: \"new\", scriptName: comm, args: { arg1: \"arg1\" } }, evt => {\n                            // console.log(evt.stdout);\n                            item.find(\"#value\").html(evt.stdout);\n                            item.find(\"#btn\").prop(\"disabled\", false);\n                        });\n                    }\n                }\n            };\n            if (this.confirmBeforeLaunch) {\n                this.jx.editor.popup({\n                    title: \"Launch Script\",\n                    content: \"Etes vous s√ªr de vouloir executer ce script ?<br>\" + (this.data.title || this.data.id) + \"<br>\" + this.data.description,\n                    buttons: {\n                        ok: { label: \"Lancer\" },\n                        close: { label: \"Fermer\" }\n                    },\n                    onclose: evt => {\n                        if (evt.action == \"ok\") {\n                            clickFunc();\n                        }\n                    }\n                });\n            }\n            else {\n                clickFunc();\n            }\n        });\n        // item[0].addEventListener(\"input\", (event)=>{ this.controller.onChangeData(event); }) \n        item.find(\"#info\").click((event) => {\n            console.log(\"info\", event.target, item[0].id);\n            var panelInfo = item.find(\"#informationsPanel\");\n            panelInfo.css(\"display\", (panelInfo.css(\"display\") == \"none\" ? \"inline\" : \"none\"));\n        });\n        item.data(\"controller\", this);\n        this.item = item;\n        this.view = this.item;\n        let visible = this.jx.editor.getBoolDependsGroup(this.data.visible, true);\n        this.view.css(\"display\", (visible ? \"block\" : \"none\"));\n    }\n    get value() {\n        // console.log('GETVALUE', this.item.find(\"#value\")[0].value)\n        return this.item.find(\"#value\")[0].value;\n    }\n    /** show/hide info panel of item */\n    showInfo() {\n        this.view.find(\"#informationsPanel\").css(\"display\", \"inline\");\n    }\n    /** show/hide info panel of item */\n    hideInfo() {\n        this.view.find(\"#informationsPanel\").css(\"display\", \"none\");\n    }\n    set lock(value) {\n        if (!value) {\n            this.view.find(\"#btn\").prop('disabled', !this.editable);\n        }\n        else {\n            this.view.find(\"#btn\").prop('disabled', true);\n        }\n    }\n}\n"]}