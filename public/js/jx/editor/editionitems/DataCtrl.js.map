{"version":3,"sources":["../../../../src/jx/editor/editionitems/DataCtrl.js"],"names":["ItemShorcutsNames","DataCtrl","dataObject","view","model","_defaultPackage","defaultPackage","filters","type","modeDisplay","_createChildren","children","id","onchanged","add","console","log","evt","target","value","setValue","layout","gabaritModel","parent","treeCtrl","controller","i","length","getByPath","cc","data","packagePath","idComp","idArr","split","pop","join","editor","undefined","jx","db","classDefined","itemClass","getClass","item","warn","Todo","find","append","dataCtrl","push"],"mappings":"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","file":"DataCtrl.js","sourcesContent":["import Component from \"jx/core/comps/Component\";\nlet ItemShorcutsNames = {\n    \"Number\": \"NumberItem\",\n    \"class\": \"ClassFile\"\n};\nexport default class DataCtrl extends Component {\n    constructor(dataObject) {\n        super(dataObject);\n        this.view = this.dataObject.view;\n        this.model = this.dataObject.model;\n        this._defaultPackage = \"editionitems\";\n        this.defaultPackage = \"editionitems\";\n        this.filters = { type: \"all\" };\n        this.modeDisplay = \"tab\";\n        this._createChildren(this.model.children || [], this.model, this.view);\n        if (this.id != \"Group\") {\n            this.model.onchanged.add(evt => {\n                console.log(\"DATA onchanged\", evt.target.id);\n                this.view.value = this.model.value;\n            });\n            this.view.onchanged.add(evt => {\n                console.log(\"ITEM onchanged\", evt.target.id);\n                this.model.setValue(this.view.value);\n            });\n        }\n    }\n    _createChildren(layout, gabaritModel, parent) {\n        console.log(\"_createLayoutView\", layout, gabaritModel, parent);\n        var treeCtrl = [];\n        console.log(this.model);\n        var dataObject;\n        this.controller = this;\n        for (var i = 0; i < layout.length; i++) {\n            dataObject = layout[i];\n            console.log(dataObject);\n            if (!dataObject.type) {\n                dataObject = gabaritModel.getByPath(dataObject.id);\n            }\n            else {\n                dataObject = this.cc({ type: \"editionitems.DataModel\", data: dataObject });\n            }\n            console.log(dataObject);\n            // determine path of class package.sdir.ClassName\n            var packagePath = null;\n            var idComp = null;\n            var idArr = dataObject.type.split(\".\");\n            if (idArr.length > 1) {\n                idComp = idArr[idArr.length - 1];\n                idArr.pop();\n                packagePath = idArr.join(\"/\");\n            }\n            else {\n                idComp = idArr[0];\n            }\n            // if no path provided (only classname), we determine default package\n            if (!packagePath) {\n                var packagePath = (dataObject.editor != undefined && dataObject.editor.type != undefined) ? dataObject.editor.type : this.defaultPackage;\n            }\n            // console.log(\"packagePath\", packagePath, item)\n            // console.log(\"jx/editor/\"+packagePath+\"/\"+idComp)\n            idComp = ItemShorcutsNames[idComp] || idComp; // converts if shortcut id\n            console.log(\"IDD0\", idComp);\n            if (this.jx.db.classDefined(\"jx/editor/editionitems/\" + idComp)) {\n                var itemClass = this.jx.db.getClass(\"jx/editor/\" + packagePath + \"/\" + idComp);\n                var item = new itemClass({ jx: this.jx, data: dataObject });\n                //item.onchanged.add(evt=>this.controller.onChangeData(evt))\n            }\n            else if (this.jx.db.classDefined(\"jx/editor/\" + this._defaultPackage + \"/\" + idComp)) {\n                console.log(\"DEFAULT\", \"jx/editor/\" + this._defaultPackage + \"/\" + idComp);\n                var itemClass = this.jx.db.getClass(\"jx/editor/\" + this._defaultPackage + \"/\" + idComp);\n                var item = new itemClass({ jx: this.jx, data: dataObject });\n                //item.onchanged.add(evt=>this.controller.onChangeData(evt))\n            }\n            else {\n                console.warn(\"EditionItemGenerator._addItem_\" + idComp + \" not exists\");\n                var item = new Todo({ jx: this.jx, data: dataObject });\n                // item.onchanged.add(evt=>this.controller.onChangeData(evt))\n            }\n            if (parent.view.find(\"#mapList\").length > 0) {\n                if (dataObject.children) {\n                    parent.view.find(\"#mapList\").append(`<li id=\"${item.data.id}Tab\"><a href=\"#${item.data.id}\"    data-toggle=\"tab\">${item.data.id}</a></li>`);\n                }\n                console.log(\"IDDD1\", item.data.id);\n                parent.view.find(\"#map\").append(item.view);\n            }\n            else {\n                // if(dataObject.children){\n                // \tparent.view.append(`<li id=\"${item.data.id}Tab\"><a href=\"#${item.data.id}\"    data-toggle=\"tab\">${item.data.id}</a></li>`);\n                // }\n                console.log(\"IDDD\", item.data.id);\n                parent.view.append(item.view);\n            }\n            var dataCtrl = this.cc({ id: idComp, type: \"editionitems.DataCtrl\", view: item, model: dataObject });\n            treeCtrl.push(dataCtrl);\n            // if(idComp == \"DataObject\" || idComp==\"Group\"){\n            // \tthis._createLayoutView(dataObject.children, gabaritModel, item);\n            // };\n        }\n        ;\n    }\n}\n"]}