{"version":3,"sources":["../../../../src/jx/editor/editionitems/DropFilesZone.js"],"names":["DropFilesZone","dataObject","Object","assign","id","rootPath","view","dom","dropzone_template","acceptedFiles","Sound","Image","ImageSequence","PDF","PSD","FLA","Flashtml","Video","_controller","numFiles","finishDrop","dropZone","Dropzone","url","previewTemplate","$","html","maxFiles","parallelUploads","clickable","addRemoveLinks","previewsContainer","dictMaxFilesExceeded","autoProcessQueue","init","on","file","json","console","log","type","removeFile","alert","event","xhr","formData","append","name"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAGqBA,a;;;AAIjB,+BAAYC,UAAZ,EAAwB;AAAA;;AAAA,iIACdC,OAAOC,MAAP,CAAc;AAChBC,oBAAI,EADY;AAEhBC,0BAAU;AAFM,aAAd,EAGHJ,UAHG,CADc;AAKvB;;;;sCAES;AACN;AACA,qBAAKK,IAAL,GAAY,KAAKL,UAAL,CAAgBM,GAA5B;AACA,oBAAIC,inBAAJ;AAYA,oBAAIC,gBAAgB;AAChBC,2BAAO,sBADS;AAEhBC,2BAAO,gCAFS;AAGhBC,mCAAe,gCAHC;AAIhBC,yBAAK,iBAJW;AAKhBC,yBAAK,2CALW;AAMhBC,yBAAK,iBANW;AAOhBC,8BAAU,iBAPM;AAQhBC,2BAAO,WARS,EAApB;AAUA,oBAAIC,cAAc,IAAlB;AACA,oBAAIb,WAAW,KAAKJ,UAAL,CAAgBI,QAA/B;;AAEA,oBAAIc,WAAW,CAAf;AACA,oBAAIC,aAAa,IAAjB;AACA,qBAAKC,QAAL,GAAgB,IAAIC,QAAJ,CAAa,KAAKhB,IAAL,CAAU,CAAV,CAAb,EAA2B;AACvCiB,yBAAK,aADkC;AAEvCC,qCAAiBC,EAAEjB,iBAAF,EAAqBkB,IAArB,EAFsB;;AAIvCC,8BAAU,GAJ6B;AAKvCC,qCAAiB,GALsB;;AAOvCC,+BAAW,IAP4B;AAQvCC,oCAAgB,IARuB;AASvCC,uCAAmB,KAAKzB,IAAL,CAAU,CAAV,CAToB;AAUvC0B,0CAAsB,EAViB;AAWvCC,sCAAkB,IAXqB;AAYvCC,0BAAM,gBAAY;AAAA;;AACd,6BAAKC,EAAL,CAAQ,SAAR,EAAmB,UAACC,IAAD,EAAOC,IAAP,EAAgB;AAC/BC,oCAAQC,GAAR,CAAY,SAAZ,EAAuBH,IAAvB,EAA6BA,KAAKI,IAAlC;AACA,mCAAKC,UAAL,CAAgBL,IAAhB;AACH,yBAHD;AAIA,6BAAKD,EAAL,CAAQ,kBAAR,EAA4B,UAACC,IAAD,EAAU;AAClCM,kCAAM,kDAAN;AACH,yBAFD;AAGA,6BAAKP,EAAL,CAAQ,WAAR,EAAqB,UAACC,IAAD,EAAU;AAC3BE,oCAAQC,GAAR,CAAY,WAAZ,EAAyBH,IAAzB,EAA+BA,KAAKI,IAApC;AACH,yBAFD;AAGA,6BAAKL,EAAL,CAAQ,MAAR,EAAgB,UAACQ,KAAD,EAAW;AACvBL,oCAAQC,GAAR,CAAY,MAAZ,EAAoBI,KAApB;AACAxB,uCAAW,CAAX;AACAC,yCAAa,KAAb;AACH,yBAJD;AAKA,6BAAKe,EAAL,CAAQ,SAAR,EAAmB,UAACC,IAAD,EAAOQ,GAAP,EAAYC,QAAZ,EAAyB;AACxCP,oCAAQC,GAAR,CAAY,SAAZ,EAAuBH,IAAvB;AACAS,qCAASC,MAAT,CAAgB,UAAhB,EAA4BzC,WAAW,WAAX,GAAyB+B,KAAKW,IAA1D;AACH,yBAHD;AAIH;AAhCsC,iBAA3B,CAAhB;AAmCH;;;;;;sBA5EgB/C,a","file":"DropFilesZone.js","sourcesContent":["import Component from \"jx/core/comps/Component\";\n/**\n */\nexport default class DropFilesZone extends Component {\n    /**\n    * @param {object} dataObject\n    */\n    constructor(dataObject) {\n        super(Object.assign({\n            id: \"\",\n            rootPath: null\n        }, dataObject));\n    }\n    /** add drop functionnality on item */\n    _create() {\n        super._create();\n        this.view = this.dataObject.dom; //$(`<div style=\"height:50px;background-color: #00FF00\"/>`);\n        let dropzone_template = `\n\t\t<div class=\"dz-preview dz-file-preview\">\n\t\t  \t<div class=\"dz-details\">\n\t\t    \t<div class=\"dz-filename\"><span data-dz-name></span></div>\n\t\t    \t<div class=\"dz-size\" data-dz-size></div>\n\t\t    \t<div class=\"dz-image\"><img data-dz-thumbnail></div>\n\t\t  \t</div>\n\t\t  \t<div class=\"dz-progress\"><span class=\"dz-upload\" data-dz-uploadprogress></span></div>\n\t\t  \t<div class=\"dz-success-mark\"><span>✔</span></div>\n\t\t  \t<div class=\"dz-error-mark\"><span>✘</span></div>\n\t\t  \t<div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n\t\t</div>`;\n        var acceptedFiles = {\n            Sound: \"audio/mp3,audio/mpeg\",\n            Image: \"image/png,image/jpg,image/jpeg\",\n            ImageSequence: \"image/png,image/jpg,image/jpeg\",\n            PDF: \"application/pdf\",\n            PSD: \"application/psd,image/vnd.adobe.photoshop\",\n            FLA: \"application/fla\",\n            Flashtml: \"application/zip\",\n            Video: \"video/mp4\" // /ogg /webm\n        };\n        var _controller = this;\n        var rootPath = this.dataObject.rootPath;\n        //console.log($(dropzone_template)[0].innerHTML);\n        var numFiles = 0;\n        var finishDrop = true;\n        this.dropZone = new Dropzone(this.view[0], {\n            url: \"/fileupload\",\n            previewTemplate: $(dropzone_template).html(),\n            //acceptedFiles: acceptedFiles[itemData.asset.type],\n            maxFiles: 500,\n            parallelUploads: 200,\n            //dictInvalidFileType: \"Fichier non valide\\nLe format du fichier doit être de type '\"+itemData.asset.type+\"'\",\n            clickable: true,\n            addRemoveLinks: true,\n            previewsContainer: this.view[0],\n            dictMaxFilesExceeded: \"\",\n            autoProcessQueue: true,\n            init: function () {\n                this.on('success', (file, json) => {\n                    console.log('success', file, file.type);\n                    this.removeFile(file);\n                });\n                this.on('maxfilesexceeded', (file) => {\n                    alert(\"Nombre de fichiers supérieur au nombre requis: 1\");\n                });\n                this.on('addedfile', (file) => {\n                    console.log('addedfile', file, file.type);\n                });\n                this.on('drop', (event) => {\n                    console.log(\"DROP\", event);\n                    numFiles = 0;\n                    finishDrop = false;\n                });\n                this.on(\"sending\", (file, xhr, formData) => {\n                    console.log('sending', file);\n                    formData.append(\"destPath\", rootPath + \"/dropbox/\" + file.name);\n                });\n            }\n        });\n        //console.log(dropZone)\n    }\n}\n"]}